using System.Text.RegularExpressions;

namespace Day12
{
    internal class Program
    {
        static void Main(string[] args)
        {

            Console.WriteLine("Program started");
            
            //Console.WriteLine("Starting setup..");

            string demo = "???.### 1,1,3\r\n.??..??...?##. 1,1,3\r\n?#?#?#?#?#?#?#? 1,3,1,6\r\n????.#...#... 4,1,1\r\n????.######..#####. 1,6,5\r\n?###???????? 3,2,1";
            string input = ".??.?#??##???. 1,6\r\n?#???.#??#?????.? 3,1,3,1,1\r\n??#????#??#???.?? 4,7,1\r\n??#?.?#?#???#?#?? 1,11\r\n?????????? 1,4,1\r\n?#?#????..?????? 6,4\r\n?#?#?.#?#???????..? 5,1,1,3,2,1\r\n?.#??#??.??????.? 6,1,1,1\r\n##???###?.##?? 2,4,2\r\n???.#??#????.??? 3,7,2\r\n????#??..?# 1,3,1\r\n.?..#????????#????? 1,5,6\r\n?#..??##??.??? 1,5,2\r\n?#???#???# 1,1,2\r\n#???#??..?????.??.?. 5,1,1,1,2,1\r\n??#??.?#??????. 2,2,1,1,1\r\n??????.???..??#?? 1,2,1,4\r\n.?#??#???#??#?????. 12,3\r\n??#???#?.?##?.?? 6,3\r\n?#?#?.??#???? 3,1,1,1\r\n??#???.#??.#. 3,2,1\r\n??#...??.. 3,2\r\n#?#.??????#.??????? 3,2,1,1,7\r\n?#?#.?????#???? 3,5\r\n?#??.???.?.?.???? 4,1,1,3\r\n????????.##?#.???? 2,1,4,2\r\n?#??#.??????????#? 4,3,1,3\r\n.#?#?.???..? 3,1,1,1\r\n?..##.???#????. 2,2,2\r\n.#??#?#??#?.? 9,1\r\n???.??..?#??#?? 1,1,2,1,1\r\n.??#??#..#????? 2,1,1,2\r\n.???#??..??????####? 4,2,7\r\n????#?.??. 1,1,2\r\n?#??#?#?..???#?.?.?# 1,5,1,1,1,2\r\n??????#???.?.??.?#?? 10,1,2,1,1\r\n???.????..? 2,1,2\r\n??.#???????? 1,1,4\r\n??.??#???.?????#? 1,1,1,1,6\r\n?..????##.##?#?????? 6,6,2\r\n##???#?.??#.???? 7,2,3\r\n????#??#??#? 1,6,2\r\n.???.??..#..?#??? 1,1,1,1\r\n?.???.?.???????? 1,1,1,3,4\r\n?.?????#?#.?????#??# 7,1,5\r\n?????##?#?? 2,6\r\n???.#?#????#. 1,5,2\r\n????...?#?? 1,2\r\n.????.?????#. 2,3\r\n?.?????##??###?##??# 1,1,11,2\r\n#??..?#?.???#??. 2,1,3\r\n#?.???????#???#. 2,1,1,1,3\r\n?#???..#?? 5,3\r\n????#???#.?#???#?.#? 2,2,1,1,4,2\r\n.????#??##???#?#. 8,4\r\n???????????#?.??#. 2,1,4,1,1\r\n?.#?#??.??####??? 5,8\r\n?#?#?#???.#.?#. 8,1,1\r\n?.??.????#?.??.? 1,5,2\r\n#??.?#...? 1,1,1\r\n??#?#???#??#.????.?# 8,2,4,1\r\n.?#?####??? 7,2\r\n???#??#?.??? 4,3\r\n..????##????????.? 8,2,1\r\n???#?#?##?.???.? 7,2\r\n?#???#?#.?.??#.?. 6,1,1,3,1\r\n???.?#?.?? 1,1,1\r\n???????#..# 4,2,1\r\n?.?#.?????? 1,1,2\r\n.????????#???##?#? 4,1,4,4\r\n???#?#?????#?#?? 1,13\r\n#????#????.#?#???#? 2,5,8\r\n.????#.#??. 4,2\r\n??#????#??? 8,1\r\n?.##.??#??? 2,4\r\n#????#?#?#?.?????#? 1,1,1,4,1,3\r\n????#????.?????##??? 2,5,1,1,2,1\r\n..???#??..?#? 6,2\r\n?#?.?.##???????? 3,1,2,4,1\r\n.?.???##?????# 1,5,1,1\r\n?.#????.??? 2,1,1\r\n?#?#?#.???..???.??? 5,1,3,3\r\n.?.???#??#?.???#? 1,6,4\r\n?#???.?#?#.????#? 5,4,1,2\r\n.?#????????...#??? 2,2,4,4\r\n?????.???#? 1,4\r\n????#?.????.?#??.??? 5,1,2,1,3\r\n????????.? 2,2\r\n..??#???#?#.?#? 9,1\r\n????????#????#????? 5,3,1,1\r\n#?????#??????. 1,1,3,1\r\n?..#?.#???? 2,4\r\n..#?????????#?#???? 1,13\r\n?.?#.???#?? 1,2\r\n#?.#??????????#? 1,2,1,2,3\r\n.???????.?#.?? 1,3,2,1\r\n.????.?#?????##?? 3,3\r\n????###?##??.??#???? 1,8,5\r\n#?.?####????.? 2,6,1,1\r\n??.##???#?????? 1,6,2\r\n??.??#???#?#? 1,3,1,4\r\n.??.???.?#?#??? 1,2,5\r\n??.#.?#???.##??? 2,1,1,1,5\r\n???.???.??.?????#? 1,1,1,1,3,2\r\n?#?.?#?##???#???#??? 1,11,2\r\n??#????.?. 1,1\r\n.?#??##??#???.?? 10,1,2\r\n?#?#?.?#.? 1,1,2\r\n????#???????#. 3,1,1,1\r\n.??#?..??.???.??? 3,1,2,1,1\r\n.?#??.???#? 2,1,1\r\n?.?#.??##?????????? 1,1,8,1,1\r\n?.?????.??#?? 4,1,1\r\n?.??.#???? 1,4\r\n???#???..???.? 2,1\r\n.??????#?#??.?.? 2,5,1,1\r\n#??#??..?.?.???.#?? 6,1,1,3\r\n.???.?#?#??.??#???? 3,1\r\n.??#?..???? 4,2\r\n?.##???#???#??#.?? 2,8,1\r\n????#.#.???.???# 1,1,1,2,4\r\n#???????????.???#.? 6,1,3,1,1\r\n?#?????.??##??. 1,1,1,1,2\r\n?..????..?#? 1,1,1,3\r\n.??..????.?#?? 2,1,1,3\r\n????????????. 1,1,7\r\n???.?.??????#.?? 1,1,1,3,1\r\n?##...?..##??. 2,3\r\n.???##?????? 1,5,1\r\n.??#?.??????#???#?? 4,7\r\n.?#???.?.?? 4,1\r\n.???###???#??..???? 8,1\r\n???.?????#??##?.. 3,5\r\n??##??#??????? 5,2\r\n.?.???.#..? 1,1\r\n??##.??#??#???. 4,6\r\n?#????#..##?#? 1,3,4\r\n.?.?.??..? 1,1,1\r\n??????????#??#. 1,1,1,1,2\r\n??##???.???.????. 1,5,3,1,1\r\n???????.?????#?##??? 7,9\r\n##..#???.?#???#?? 2,1,1,4,2\r\n????#??#??????? 8,1,2\r\n.##?##???????.???# 7,1,2,1,1\r\n#.?..????#?#. 1,1,1,5\r\n???#??#????.??? 2,1,1,1,1\r\n#.??#.???#?##?#????? 1,1,1,3,4,2\r\n???###?#?.???.??? 6,2,1,3\r\n???#?#???????? 8,1\r\n??????.#???.?..??.? 3,1,3,1,1,1\r\n???#?##??#?.??.#.?? 1,8,2,1,1\r\n??????##???.#??#?? 8,2,3\r\n??.??#??.??.# 2,1\r\n??#.???#??????#? 3,3,4,2\r\n#?..???????#??#???? 1,5,6,1\r\n.??####??.???. 5,2\r\n.??#???????#? 1,1,4\r\n.?????.#?#???#?# 1,1,3,1,3\r\n.??#??#???..#.?.?# 1,1,4,1,1,1\r\n??.??????????.? 2,2,3,1\r\n???#.?.???##?## 4,8\r\n.?###??????#??#??? 5,7,1\r\n??.???.??#????#??? 2,2,1,1,5\r\n#???????.?#.#???### 3,1,2,1,3\r\n.????#???..?.#?? 4,1\r\n???????????.?#.?? 3,2,4,1,2\r\n.??#.#?.?.??##?.? 3,2,1,4\r\n??#??.?##???#? 2,3,2\r\n?????###?.? 2,5,1\r\n#?#.?##????#???? 1,1,3,1,5\r\n???#??#????????## 9,2\r\n?#??##??##???##??.?? 2,11,1,1\r\n???.?#.???? 1,1,1\r\n#???#????????.#? 1,4,1,2,1\r\n?#??.??##? 2,4\r\n.###??#??#??#?# 3,10\r\n#.????#?#??????#?? 1,2,4,2,2\r\n??..????.? 1,1,1\r\n#??##?..??????? 5,1,1,1\r\n##????.?.##???. 3,1,5\r\n???##.????#? 5,1,3\r\n?.????.##.? 1,2,2\r\n?#????##??????##???? 1,2,3,8,1\r\n???#?????.?..? 3,1\r\n?#?#??.#??#?.? 5,4\r\n??.?###??????? 1,4,1,1\r\n..##????#???#???? 4,6,3\r\n?????#??????.???# 7,3,1,1\r\n??#???????. 3,1,1\r\n??????##??????. 1,1,2,1,1\r\n?????.??????. 1,1,2,1\r\n?.?.??.?#?????#?##.# 1,1,1,8,2,1\r\n?.#???????#?? 2,1,3,1\r\n.#????..??#?..?# 4,1,1\r\n.??.??#??? 1,1,1\r\n##??###??.??? 8,1\r\n????#???????.????? 6,1,1\r\n#?#??#??..????? 1,2,1,1,5\r\n.?#????.?.??#? 6,1,1,2\r\n????..?##.?.?.????#? 4,3,1,1,1,3\r\n.#???????##??.???#?# 5,6,4\r\n##??????#?..#??? 2,1,5,1,1\r\n#????????#?#.#?.? 1,1,1,4,1\r\n#??#???#.?????#???? 8,1,1,5\r\n#?.?#??#?.? 1,2,2\r\n?.#?#??.?????..? 4,3\r\n?#?#???.?? 4,1,1\r\n???????#????#???.? 1,2,2,2,4,1\r\n????#??..?.??#?#?. 5,3\r\n..??#?#????????#???. 5,1,3,1,1\r\n?.#???.???. 1,2\r\n??????????.?.??? 6,1,1,1,1\r\n?#??????.? 3,2,1\r\n.?.##???## 1,7\r\n?.?????#??##??##???? 1,16\r\n??#????##?#??? 1,1,7,1\r\n.?????????? 5,1\r\n??????????.? 2,1,1,1\r\n##?.?????. 3,1\r\n?#?..?.???? 2,1,1\r\n#..???#??#???# 1,2,8\r\n??##?????#????? 3,9\r\n???#?.?##. 3,3\r\n??.??#?#??##?#.# 9,1,1\r\n#.??#?#??. 1,3\r\n.??#????????????? 3,1,2,3\r\n??#??#???.?.?? 7,1\r\n??#..##????#??#????? 2,10,2\r\n#?###????##?..??? 11,2\r\n.???#.??#.?##.?? 1,1,1,3,1\r\n?#??????#? 5,1,1\r\n?.?##??#??????? 5,4\r\n.?????.?#??.. 2,2\r\n.??.?#####?????##? 7,4\r\n??????.#?.. 1,1,2\r\n??#??????..?? 3,1,2\r\n??????????# 4,2\r\n?.?######???. 1,7,1\r\n????#?????????# 10,2\r\n.???#?#?#? 1,2,4\r\n?##????.???#?#?? 5,5\r\n.??#??.?#?#?.##? 1,4,2\r\n#.????????#????. 1,6,2,1\r\n?###????.?#?#??#??.? 6,9,1\r\n?..??..??###. 1,2,5\r\n?????#?????????.??. 1,1,3,6,2\r\n?.?#??.??? 1,1,2\r\n.??.?????????. 1,5,1,1\r\n????#??.?????## 3,6\r\n##?#??.?????. 4,1,1,2\r\n??#????#??.????#?. 8,1,2\r\n.???????#.?.?#??#??? 1,2,2,1,7\r\n?#.#???.?#?????# 1,1,1,1,5\r\n??#?##?.??# 6,3\r\n??????.##??#??###? 1,1,1,5,4\r\n???#???????##??. 2,1,1,2,1\r\n?????#..????#??##? 6,1,3,3\r\n????#??#??#??????##? 11,3\r\n.##??##?????.#?#?? 11,1,1,1\r\n?.?#?.?????.?? 3,4\r\n###?.????#?? 3,1,3\r\n????..?##?.??????#?? 3,2,9\r\n?#?.???#??#. 2,1,4\r\n??##?#?.#.???#??? 6,1,1,1,1\r\n#??????.???.#?#??. 4,2,1,1,3\r\n.?#???????.##? 7,2\r\n???#???.?.?#?#?. 4,1,5\r\n?.?????#.??#???# 6,3,1\r\n.??#??#??.?#??? 6,1,1\r\n??#????????. 5,1\r\n????????????? 1,4,1\r\n?#??#?####?.??.?#... 10,1,2\r\n#????#??????#???.?? 1,1,4\r\n?.???.???### 1,1,1,4\r\n?####??.?.??????. 7,4\r\n#???.#?#?#?#.?#?? 2,7,2\r\n???..?.??#???. 1,1,6\r\n???????.????####??.? 4,1,10,1\r\n??.?#?????????..?.# 2,11,1\r\n???.???#??.. 1,1,3\r\n?.?#?#??#????#?? 1,2,2,3\r\n???#????.?#??. 3,1,1,1\r\n.????????? 1,1,1\r\n?.?.????##?###??.?? 1,11,1\r\n?#????.#?#??? 1,1,1,2\r\n#.?.?..#?#?#????? 1,1,3,4\r\n?#?.??..?##?##????? 3,10\r\n?????????#????.#???? 1,7,1,2,1\r\n?#????????.#?# 1,4,2,3\r\n.????????#?. 6,2\r\n?.?#.??##.#??.?#?? 1,2,1,2,1,2\r\n.?????#??.?#?? 2,3,2\r\n#?.##?..#.???????? 2,2,1,5\r\n?????.?#????? 1,1,1,3\r\n???????#?##??#??? 1,10\r\n???##?..#? 1,3,2\r\n???#???.???.?? 2,1,1\r\n#?.#..?.?? 1,1,1\r\n????#???#?. 2,6\r\n##.?.????#??.?#?## 2,1,1,1,1,5\r\n??...?#??##.#???? 2,5,1\r\n??????..?#???? 3,1,1,1\r\n?#?.?##???#?.???? 1,8,1\r\n???##?#???????.#? 5,6,1\r\n?????..?#????# 1,1,2,2\r\n?###..??#? 3,4\r\n..?#??#????# 5,3\r\n???.???#????. 1,1,6\r\n??#?.??#?.???. 1,3\r\n?..????...?.????? 4,1\r\n#.??#??#?.#??#??#?# 1,6,1,7\r\n?.????..?.?? 1,3,1,2\r\n.??#???#??????#?.?# 1,1,10,1\r\n.#.?.??#?.?.#?? 1,1,2,1\r\n?.?.??.#???#? 1,1,1,3\r\n?.???.???.?? 1,3,2,2\r\n.????.??????. 1,1,1,2\r\n?.?#??????.??#? 1,5,1,1,1\r\n?????????#. 1,2,1\r\n.?.?#??##???? 1,6,1,1\r\n?#??#??.#? 1,1,1\r\n??.???????#??#.? 2,1,1,5\r\n#?.#??.?.##..##?.?. 1,3,2,3,1\r\n????????#?.##?#? 2,1,2,5\r\n?#?????.#?#.??#? 3,1,1,1,1\r\n????#?#?????#? 2,3,4\r\n?.???????#. 1,3,1\r\n???????##?#???.????. 14,3\r\n??????#?.#?#?? 6,4\r\n?##?#.??##?.# 5,4,1\r\n#??.???###?????? 3,1,3,1,1\r\n?#?#??.???#?#??? 5,2,4\r\n.???#?.#?####. 1,1,6\r\n.???.?#?#??.# 2,1,2,1\r\n#.#??#????? 1,6,1\r\n?.??.???.. 2,1\r\n?.??.#?##.?????#???. 1,4,8\r\n.#?#?#?#???..?#??# 9,4\r\n.#.?#?#??.# 1,6,1\r\n#?#.???#?????? 3,1,7\r\n??#?###??#?#??#??? 1,6,1,1,2,1\r\n??.?##???#?#?.? 1,10\r\n.#?##???#???##???..# 1,11,1,1\r\n??.#?.????#???# 1,1,7,1\r\n#????????#? 1,6,1\r\n????.#?.??#???#.?# 1,1,1,4,1,1\r\n.???#?#??.?.???# 7,4\r\n???##??????..## 8,2,2\r\n?#?#?.?.?##?## 5,5\r\n?.?..???.. 1,2\r\n.?.????..# 1,3,1\r\n#??????#??.?#?###??? 1,1,1,1,1,8\r\n.??#??.?.???? 4,1\r\n??????##?.. 2,3\r\n?#.????.#?# 1,1,3\r\n.?????..?????#. 2,1,2\r\n????#?#?##.????? 10,1\r\n?????.????#?? 3,1,1,1\r\n.??????.??.??..? 6,1\r\n?????????#??#???# 1,2,3,5\r\n#??####??..??#?.. 9,1,2\r\n?####??##?.????? 9,1\r\n?##??#??.???#. 6,4\r\n#.#?????????.#????? 1,1,1,1,1,5\r\n??#???????###??#??? 5,8\r\n#??##?????#????#? 1,7,1,1,1\r\n????????#?.????.???. 1,1,3,1,3,3\r\n??.??????? 1,2,1\r\n.?####???.???#?.? 4,1,3\r\n.???##??#?????.???? 13,1\r\n???.??#??#?????????? 1,1,3,7\r\n?????..??.?? 1,1,1,2\r\n?#???#??#??#???.??? 7,6,1\r\n???#???#?#??????. 6,1,2,1,1\r\n???????.?????? 1,3,2,1\r\n..#???#???#????#? 1,10\r\n??##??##???.???# 6,1,1\r\n#?#???###?##?.?????? 1,1,1,7,1,1\r\n??#?.?#?.???? 1,2,2\r\n.?..???#.? 1,4\r\n#??????#.?#?.##???## 3,1,2,7\r\n...#??#??#?##??.. 10,1\r\n.#??.??????????? 3,2,1,1\r\n?#??#?#?#????###??. 2,15\r\n?#????#??.?????? 2,4,6\r\n??.??.????##. 1,1,1,4\r\n.??#???.?.?????? 4,1\r\n?#??.??##??#??.? 2,8\r\n????#?#??#???##????. 1,15\r\n.???????#..?#?? 2,4,2\r\n?.?#?#?.#.?.??? 1,2,1,1,1\r\n???????#?##?#??? 1,6,2,1,1\r\n#???#####?.???#??. 10,4\r\n??????#.?????.? 2,3,4\r\n?.?#?#?????.? 4,1\r\n?.#?#?..????????#. 1,4,1,3,1\r\n.?????????#??##?? 3,1,7,1\r\n#.?.?.???##.??? 1,1,1,2,1\r\n?#.??##??.?..#? 2,3,1,2\r\n?#.?.????????#? 1,2,6\r\n???#?.??##?#???#??. 1,2,1,10\r\n???????.?#????? 6,3,2\r\n????#?.????.??.? 1,2\r\n#???.??#.??? 1,1,3,2\r\n???.??#??#????? 1,2,3,1\r\n?#?#????#?.?? 2,1,4,1\r\n.#???????#??#? 3,1,5\r\n?#.???.#.????#? 1,2,1,5\r\n.???#???##.??????.# 6,2,1,1,1,1\r\n.??????????? 1,1,4,1\r\n..??????????#?#?#?#? 6,10\r\n???.#????#.# 1,3,1,1\r\n#???????##?#..?? 1,1,5,1,1\r\n??#???#?#?.??...??# 10,1,2\r\n?#???#??..?????#???. 7,3,2\r\n???????????#??. 1,2,1,1,1\r\n#????#???##??.?.?#.? 1,11,2\r\n?????.??.???.?# 5,1,3,1\r\n?.#?#?#?#?#?#??? 1,1,1,3,5\r\n??.????.???? 2,3\r\n???????#??#? 1,3,2,1\r\n???.??#???#? 1,4,2\r\n??.??#?#.#????? 1,1,1,2,3\r\n???#????.?????.?.??? 5,1\r\n???#?.???##???####. 2,10\r\n.??#..?.???? 2,2\r\n?#.???#??##??? 1,7\r\n?????????##?? 3,1,3\r\n.?#?#?.?.#? 4,1,2\r\n.?.?#??.????#?? 1,2,1,3\r\n?#?#?????.??#?.??? 7,3,1\r\n.#???????#????.#..?? 3,4,3,1,1\r\n?.?#.????.#??#???# 1,1,1,1,6\r\n??##??#???#?#..# 4,7,1\r\n????#????. 5,2\r\n??#?#?.?.?..??? 2,1,1,1,1\r\n##????#?##??? 2,1,1,5\r\n??#..?#?##??? 2,8\r\n?.??#??????#?? 6,2\r\n??.?.???.??? 1,1,1,1\r\n?.?????#??? 1,4\r\n??#???????#??????? 1,7,1,1,1,1\r\n????..??.?????.#?? 2,1,1,1,1,3\r\n?#?#??.???????? 2,2,6,1\r\n??.??#?????##?? 2,2\r\n???.???????????.?? 1,2\r\n??##??????#?#??.# 2,1,2,3,1\r\n??????#??#? 3,1,1\r\n??.?????##????##??? 2,14\r\n?#?.?..??? 1,3\r\n?.??????#? 2,1,1\r\n??.??##.?? 2,2,1\r\n.??.??.??? 1,1\r\n.?#????#??. 2,3\r\n???????#???.#? 3,2,1\r\n??#???..?? 6,1\r\n...?#???###????? 2,4\r\n#?.?.???????? 1,1,1,2\r\n?????#????#??.?? 7,2\r\n.?????#??.???????? 4,3\r\n?###??.?.?.?##??#?? 3,1,1,7\r\n??#?#?##??...??? 9,1\r\n?????#?#?????.?##? 12,3\r\n???????????..#??. 8,3\r\n?#??#?##???#??? 7,1\r\n??????###??## 1,10\r\n?#??????#????#####.? 2,2,1,8,1\r\n.?###???..??#???.? 4,1,3\r\n?.???????? 1,6\r\n???#??#.??#?##??.? 4,2,7\r\n??.#??#??##??#?##. 2,2,11\r\n??.??#?#... 1,4\r\n.?.#?#?.?????#? 1,4,5\r\n.?????.???#?#?#??#? 4,9\r\n??.#?????#?#????? 1,12,1\r\n???#???#????.#???? 1,7,1,1,1,1\r\n??.?????##?.?..#?#.# 1,1,3,1,3,1\r\n.?#??##?????###?# 1,7,3,1\r\n#???????????#????#?? 1,2,1,1,1,7\r\n####??##???#??. 9,4\r\n???#???#?.??#? 4,3,1,2\r\n???..#???? 1,1,1\r\n?#????#?.????.??#? 3,1,1,2,1\r\n.?#????##? 4,4\r\n??.???.??? 1,2,1\r\n.??##??.????#??? 3,1,8\r\n????????#? 1,4\r\n.#????#???????.?.? 6,1,2,1\r\n??.??????##??#?#?#? 1,1,8,3\r\n??????###? 1,3\r\n???#..#??#.??.?#? 4,1,2,1,1\r\n?.##??#????..##?? 7,2\r\n#??#????#?? 5,2\r\n.#??.?#?#???? 2,3\r\n?.??#??##?????.??#? 3,2,2,3\r\n?.#???##????.? 10,1\r\n.##???.#??? 5,2\r\n??#?????.?#.???.?# 2,2,1,1,3,1\r\n?#?????.#??#???#???? 1,10\r\n?##?#..???#??#??#??? 3,1,1,6,1,1\r\n?.?????#?????????.. 2,3\r\n????#??#????#???. 1,12\r\n.#?????#????????###? 1,11,3\r\n#?#??.??###?? 3,1,3\r\n.#?????.??##???#??? 3,10\r\n.#?.??#??? 2,1,1\r\n.???##?..?. 5,1\r\n?.??#??.???? 2,1,2\r\n?.??.#?.????#?????# 1,1,2,1,9\r\n.??????#?#????.?#?. 8,1,3\r\n?##???????.#. 3,3,1\r\n#???????#.???? 9,3\r\n?#???.##??#??? 4,7\r\n????.?#??.?.#?#??? 2,4,5\r\n.?????#?#??#?????# 7,1,1,1\r\n#??..???#??#? 3,4\r\n???.??##?????##??#?# 3,7\r\n?#?#.??.?#.?#.? 1,1,1,1,1\r\n#.??????????? 1,4,3\r\n...???????##??#??#.. 1,12\r\n.???###????#??##???# 1,15,1\r\n???.?.?#?##..#? 3,5,2\r\n..??????.??#??. 2,2,4\r\n##???#?#?????? 8,3\r\n???.???#??? 1,4\r\n???.??.?#?????.#???? 2,1,3,2,1,1\r\n???#?#??#.? 1,6,1\r\n??###?????#?##.???# 10,2,1,1\r\n???##???..#??? 4,2\r\n?##??#.?#?##? 5,5\r\n??????.?#.?.?.? 1,1,2,1,1\r\n???.?#?#?.?.? 1,1,2,1\r\n???.??#?.?? 1,2,1\r\n?#????.?#.??? 5,1,1\r\n?.???.??#? 2,2\r\n??.??#??????#????##? 1,16\r\n????.????.??.?.#?#?? 1,4,1,1,1,1\r\n.??#??????? 1,3\r\n???.?????.. 1,1,3\r\n#??#?..???#?..?? 4,1,2,1\r\n??????#.????? 7,1,2\r\n?###???..?#?? 6,2\r\n?????????#??#.?? 1,1,4\r\n.????#????. 4,2\r\n.?#.?..??#.?##??# 2,1,2,2,1\r\n#?#?????#??#?.?#.#? 6,1,2,1,1\r\n????.#???#???? 2,1,2,1\r\n???#????????..#?? 8,2\r\n??##?#???.?#?..???. 6,3,2\r\n????.??#??#.?#??? 4,6,3\r\n???##??##?? 5,3\r\n???????.#..#???# 3,1,1,1,3\r\n?????????? 2,1,1\r\n#??#????#?#?????#? 11,1,3\r\n#??#??#?.???##??? 1,2,2,7\r\n#?.???#?##?##?? 2,1,9\r\n..??..??..?? 1,2\r\n.????.?#?#?.?. 4,5\r\n#???#??#???.???#??? 2,4,1,1,1,1\r\n.??#..??????#???#?. 3,1,9\r\n#???????#.????? 2,1,1,2,1\r\n??????##????#??.??. 8,1\r\n???.??#?...?#?#? 3,4\r\n?.??.#??#? 1,1,4\r\n?.??#?#??.??? 1,4,2\r\n?##??#??.????.??? 6,1,4,1\r\n??.?????#??? 1,3,1,1\r\n?.?????????#?#??? 5,8\r\n?.?????.#?##?. 1,1,1,4\r\n.?????##?#??.? 11,1\r\n.?.??#?????????# 1,1,1,5\r\n#?#????..?#??#??? 6,5,2\r\n?#??#??#?#?.???#??? 10,2,1\r\n.??????#.? 4,1,1\r\n????.?#.????? 2,1,4\r\n???????.?##? 2,4\r\n?#????#???? 4,4\r\n?.?#.???.?## 2,1,3\r\n?.????#...???..??. 4,1,1\r\n?#???#????#. 8,1\r\n?#.??????.?####?. 2,2,2,5\r\n??#?????#.?? 5,3,1\r\n?#????#??????#..?# 7,4,1,1\r\n#?????.???#?##?? 1,1,1,2,4\r\n##?#????.???. 8,1\r\n?.???????##??? 3,6\r\n???????##??#???. 1,7,1,1\r\n#?????#?.??##??????# 1,5,7,3\r\n.???????.# 2,1,1\r\n??????.?#?? 3,2,3\r\n??????#????. 7,1\r\n??#?.??.??? 3,2\r\n..??????#?#???#.? 9,1\r\n##?#??..#.? 5,1,1\r\n?#??#.????.???? 4,1,1,1,1\r\n?????#.#.?.??? 2,1,1,2\r\n???###?..??. 4,1\r\n??####?#?????#? 7,1,1\r\n??###?#???.#???????? 9,1,2,2\r\n??.??.?..####?#??? 1,6\r\n.???#?????????????# 3,2,1,1,1\r\n??#.????.????????? 2,3,5,1\r\n.?..?#?#??????#??. 1,10,1\r\n#?.???#..???. 1,4\r\n?#????????#?.. 5,5\r\n???#.#??#?##???##. 3,7,4\r\n.??###?#?.?????..?? 6,4\r\n???.???##???.??# 3,1,5,1,1\r\n..????.???? 2,1\r\n?#..?##??.#??#? 1,4,2,2\r\n????..??#?#?? 1,1,2,3\r\n#???.???????? 2,4\r\n..??????#??.???.??? 7,2,1\r\n?.#???????.. 3,2\r\n??????##????? 9,2\r\n??.#.??.?#???#?# 1,1,3,3\r\n????.#.???? 3,1,1\r\n#??.?##??#??#.?? 1,1,9,1\r\n?.????..??.???? 1,3,1,1,2\r\n??.???##??.#????? 1,5,4,1\r\n???.??.?????.?.???# 3,1,2,1,1,4\r\n?#.#???..??#??#? 2,1,1,4,2\r\n?.??.?..?????.???. 1,1,1,5,1\r\n.?#???.??.????????? 4,1,1,3,1,1\r\n???.?#.???. 2,1,3\r\n???.?#??????# 1,3,1,2\r\n????????.?????. 5,4\r\n??#.??.??? 1,1,3\r\n??#?..?#???#?.? 3,4,2\r\n????#??##???????? 7,1\r\n#??????##?.## 1,1,3,2\r\n???#.?????# 3,4,1\r\n#?#?.??????# 1,2,3,1\r\n?.??#..#..?? 2,1\r\n?????????.?????..? 7,1,1,1\r\n?????.???.??#??.??# 2,1,1,1,3,2\r\n?.?.??#?.#?# 1,1,1,3\r\n????????#.? 6,1\r\n#.????##???????? 1,5,3,1\r\n..???#.?.#?#??#??# 4,1,4,1,2\r\n.?.#?.??.??? 1,2,1,2\r\n??#??.?#???.. 2,3\r\n???#??#????#? 7,2\r\n??##?.??#? 3,4\r\n?.????#????.#?#? 1,2,3\r\n.???.???#?#????? 2,5,1\r\n.##.??.#.##? 2,1,1,2\r\n??????#??????##?.? 1,4,3,4,1\r\n???????#???.?#?# 6,4\r\n??..?????????.#??#. 1,8,1,2\r\n????????.? 1,2,1\r\n??##??##???#?.??#??? 3,6,6\r\n.??#?#???????? 3,2\r\n.??????.??##???..? 5,4\r\n????????..? 2,4,1\r\n.#?????#?#??????? 1,9,2\r\n?#####??#???.#?? 7,1,1,1\r\n#???.?#.#.?#?#?###?? 1,2,1,1,8\r\n.?#?????.??????? 6,4\r\n????.?.??##.????#?. 2,1,3,1,2\r\n???????????????#. 5,1,4\r\n.?..?.?##????? 1,1,4,2\r\n..???????? 2,2\r\n??.??#?#.? 1,5\r\n?#???.#####??? 3,5\r\n??..#?#?#???#??? 1,3,8\r\n.????????.???#? 2,1,1,1,2\r\n?????.#???????#.#. 1,2,1,2,1,1\r\n????#???#??#.?? 6,5\r\n??.?#??#??#?.??#?#?? 5,2,4\r\n???###??#?#????. 8,5\r\n.??????##.????#??.# 1,5,1,3,1,1\r\n.?????..?????? 1,1\r\n??##?.?.?? 3,1,1\r\n???#??###??????##??? 1,6,8\r\n.????#.???????.?#?#? 1,1,1,6,1,1\r\n???#..?#.?.?? 4,2,1\r\n?.?.#.?#?## 1,1,5\r\n?#???.?#?? 4,2,1\r\n?#?#?#???#?.??#.??# 5,2,1,1,1\r\n.???#?.?##?? 1,5\r\n?#???.?#.? 4,1\r\n.##??#?#...?? 7,1\r\n?##?.?.?.?#?..??. 2,3\r\n??#?#.??#?????? 4,2,2\r\n?#?###?.????.? 7,1,2\r\n#?.#?#?.?#?.#? 1,4,1,1\r\n...#?#???.???? 4,1\r\n.#?????#.?##??? 1,1,3,3,1\r\n.??#????###?????? 3,8,1\r\n?.???#??????????#??? 4,9\r\n.##?????#?? 5,1\r\n??.????#?????.?.. 1,10,1\r\n.??#?#?????..#.?.??? 2,3,1,1,1,2\r\n??????#???? 2,3,2\r\n??#??????#?????# 6,1,1,4\r\n???????.?#.??#?# 2,2,2,1,1\r\n?#.????#?? 2,6\r\n??#????????.. 5,1,2\r\n?????#????#??#?.?#?. 8,5,3\r\n??##????#?..? 5,3\r\n.?????.????#? 3,4\r\n...?.?????????#???. 1,8\r\n#?????#??.. 7,1\r\n.??#????????? 4,1,1,1\r\n?#.??????.???? 2,1,2,1\r\n#???#?#?#?????????? 9,1,1,1,1\r\n??.?.??..??#.?# 2,1,1,3,2\r\n?#?#??#???#.????.?? 10,1,2,1\r\n.???#.?????.? 3,3\r\n???#??##??.????#??#? 8,1,1,1,1\r\n????..??????#?? 1,2,2\r\n?#.?.?#..#??#?.? 2,1,1,5\r\n????###.#..? 1,4,1\r\n.????????? 1,1,1\r\n?.?...????? 1,2\r\n??#??.??##?? 3,6\r\n?.????#??#?.#?? 1,9,2\r\n?###??????#.???. 11,1,1\r\n?????#.?????? 3,1,1,1\r\n?.##..?????.?#..?? 2,1,2\r\n??#??#?????..? 4,1,1\r\n?##?#?#??.??#. 5,3,3\r\n.??.#????#???#???? 2,1,7,2\r\n?.#???????????????? 1,1,9,3\r\n.???#????##.? 1,2,2,1\r\n?#?.?.???#??#?..?.?? 1,1,6,1,2\r\n??#?????????#??? 4,1\r\n??????.??###?????.#. 3,1,1,3,4,1\r\n?????#.#.?.?#? 5,1,1\r\n????####..?#..#?# 7,2,1,1\r\n#???..??????...#?? 2,1,6,1,1\r\n?????#??.? 5,1\r\n.??#????#? 4,1\r\n???.#???.??#? 4,2\r\n.#????#??#?????? 3,3,1,2\r\n?????.??????.???? 1,1,3,1,2\r\n?#.##?#?.#####??# 1,4,8\r\n??.#????...?### 1,1,1,4\r\n#??#?#??#?.? 6,2,1\r\n????#???#?? 5,1\r\n#???#?#????##.?.? 13,1\r\n?###????#???. 4,6\r\n????????##???????. 1,4,2\r\n#?.????#.???? 1,1,2,2\r\n.????????#? 1,2,3\r\n?????##?#.??##?. 8,4\r\n?#??#?#????? 1,1,1,1\r\n????#??#?#? 1,5\r\n#??????#?#??????#??# 4,8,3,1\r\n?.?###??.????????? 3,7\r\n??#???#?????.?###?? 1,1,2,1,4,1\r\n?.??..?.??.????##.?? 2,1,1,6,1\r\n??#??????? 1,5\r\n???##??##???.#??#?# 8,1,6\r\n.?.??#?##?#?? 6,1\r\n????????##????#?# 1,1,9,1\r\n????.#?##?.?? 3,5,1\r\n??#??.????..?. 4,3,1\r\n#??#??????#??? 1,1,1,3\r\n###?#.?..#? 5,1,1\r\n?????#.??????#?#? 1,2,1,5\r\n#.???#??#. 1,3,1\r\n.??#?##????? 6,1\r\n?????#????..?? 7,1\r\n???#??#?#??#??.??? 1,2,3,2,3\r\n??????..#????#??.? 2,1,1,2,4,1\r\n?#.##?##??????.? 1,5,1,3,1\r\n??#??##????.????# 8,1,1\r\n???????#.#??#? 1,3,2,1\r\n?##?.?#???#???????? 2,2,3,2,1\r\n.#??..??.????#? 3,2,1,1\r\n???????.??????#.###. 3,3,1,5,3\r\n??#.#??#????. 2,4,3\r\n#.#??#????#??##????? 1,1,2,1,6,3\r\n##?#?.#?#.#.??? 5,1,1,1,1\r\n??????????##??#.?# 5,2,2,2,2\r\n??#.??#?????#?#?? 2,7,4\r\n???.???????.??#? 1,3,2,3\r\n?#.#??...?#.# 1,1,2,1\r\n???#?????#?#???#..## 3,9,2\r\n#.???????#. 1,7\r\n.??#????.?.????.?? 2,2,1,1,1,1\r\n?????..??. 1,1,1\r\n??#.???????#.? 2,5,1\r\n?????????? 3,1,3\r\n#.?.??##??.? 1,1,4,1\r\n??.????????#????? 1,2,3,1,3\r\n.#####????????? 6,1,2\r\n##????##?.?#.??? 9,1,2\r\n??#??????? 2,1,1\r\n????#?????????.?#. 14,1\r\n?##???##?.##??. 7,4\r\n#.?#?##??#?####???# 1,14,1\r\n.?##?.?????# 4,1,2\r\n.?#.#?.???# 1,1,2\r\n.?..???????#?.?# 1,1,6,2\r\n??##?#?????##??.???? 6,2,3,2\r\n??#??????.??#?? 7,2\r\n#.?.?..#?.??#?#?#. 1,1,1,1,5,1\r\n?.?#???????? 2,4\r\n????#??..???#?#?. 1,4,1,1,1\r\n???.?????# 2,6\r\n???#???##..?????..?? 2,3,3,1\r\n??##?##?#???###? 5,7\r\n.??#??##??#?. 2,5\r\n.#???#?#?????# 1,11\r\n?#?#?.?????.????#?? 2,1,2,1,7\r\n??#?????????# 3,1,1,1\r\n.??.????#? 2,2,1\r\n????????#????? 1,7\r\n?????.##???#?#? 1,3,3\r\n????#..??#??? 1,1,2\r\n?#?.?.#???# 2,2,1\r\n#..??.??????#. 1,2,1,4\r\n.##?.??#.?#.?? 2,3,1,1\r\n..?#???#???###.????? 12,1\r\n????.????#? 2,1\r\n???#.?.??? 1,1,1\r\n.??.????.# 1,1,1\r\n????.???.?.???##??? 3,1,6\r\n??#????.??.? 4,1\r\n#.?..###?? 1,1,5\r\n?????????..#.? 1,3,1,1\r\n???.###?#??.?. 1,6,1\r\n????????????#?##???? 3,1,9\r\n??.??.???? 1,2\r\n??#?.?????.???????? 4,5,2,4\r\n????#?#.?#####??. 5,7\r\n?.#?????#??? 1,3,1\r\n#????#??.?? 1,1,1\r\n.??????.????# 3,1,2\r\n??#?#?????#?.???#### 10,6\r\n?.?????#?..? 1,4\r\n???#??.#??#??? 2,5\r\n##?#?.#?##??##?????? 4,8,3\r\n???#???.??????## 3,1,6\r\n.???#??.??. 1,3\r\n.???#?.??.?#??? 1,2,2,1\r\n??#?.??#.?#.??##??? 3,2,1,5\r\n?###??#???###?#???.? 8,8,1\r\n###?.?.???..??.? 3,1,3,1,1\r\n?#?.?.##????#???? 1,1,4,2,1\r\n???????.?? 1,4,2\r\n.?#???###??? 1,4,1\r\n#.????.???#.# 1,1,4,1\r\n??#?#????.?#?.? 1,5,1,2,1\r\n.?#?#?#?##? 4,1,3\r\n????????????#?#????? 1,1,8,1,1\r\n#.????????? 1,2,2\r\n?##??.???? 3,1,1\r\n????..???.?.###?# 2,2,5\r\n#?#????##.#?? 5,2,2\r\n???.#????##?????..#? 1,1,6,2,1\r\n.#??.??.?? 1,1,1\r\n#????#??##??? 1,2,4\r\n?#????.??????.? 5,4\r\n??.?#???#?..?# 1,5,1\r\n?#???????????#???? 4,1,5,1\r\n???????#?.? 5,1\r\n?#??#?????.#??.#?? 5,1,1,1,3\r\n???.??????.?? 3,1,2\r\n?.???.#??? 2,3\r\n?.#.?????? 1,2,1\r\n#??#.??.#???. 1,2,3\r\n#???.#.?.?#?. 1,1,1,2\r\n?##??????.?#.?? 2,4,2,1\r\n.?#??#.?#??????? 4,4,3\r\n#????.???.??#???#.? 2,1,2,4,2,1\r\n?????.?????# 1,1,5\r\n#???#.#?.?????????? 2,2,2,9\r\n?#????????.?#.#? 7,1,1,1\r\n##?.????#?.?#??. 3,4,3\r\n???##??#????#?????? 11,5\r\n.??.??#??##.?? 1,7,1\r\n#??##???#.?.? 5,2,1,1\r\n???.??#????##??.?# 2,1,1,6,1\r\n??##?#????? 3,3\r\n#.?#??.????#??# 1,3,1,1,4\r\n..##?#??.?#? 5,2\r\n??.??#????. 1,4\r\n???#?.????? 4,2\r\n#?..????.?#??#?#?#? 1,3,9\r\n????##???#.?#?? 7,1,3\r\n?????#???????.?? 1,5\r\n??.??.????##??#???? 2,10\r\n??#?###?.?# 3,3,2\r\n???????#???.??.. 7,1\r\n??????????#.#?? 4,1,1,1,2\r\n?#?#?#??#??.??##??#. 9,5,1\r\n?.##?????.? 2,4,1\r\n#.???.???#??#?#?#??? 1,1,12\r\n?.?.?#???#?#?#.?#. 1,1,1,4,1,1\r\n???#?#???##????#??? 6,4,4\r\n?.????##..??.## 1,1,3,2,2\r\n.????#.?.??? 5,1\r\n?????..?.??#.?#? 1,2,1,2,1\r\n?.??#?????.?#? 1,5,1,2\r\n.????##?????#?? 1,4,2,3\r\n??.??.???.?#?? 1,3,3\r\n?.#????.???#??.#???? 1,1,1,6,1,1\r\n..#?????????##???## 1,4,4,3\r\n###??.##??#?????. 4,2,6\r\n?..?#????.??.?? 1,2\r\n.?#?.#????????.??? 3,1,3,1,1\r\n?#?????#?##?.###?#?? 3,7,5\r\n##??##??????#??..??? 13,1,1,1\r\n..#??.?#????#??? 1,2,6\r\n?????#?#?????##?.##? 1,7,1,3,3\r\n?##?#?#?##? 6,2\r\n.??#??..???? 4,2\r\n.#?##????.???. 1,3,1,1\r\n??##??.?#.? 4,2,1\r\n???.???#?# 3,2,1\r\n.????..?##???#??#. 2,10\r\n?##?????#??.## 5,2,2\r\n??????.??? 3,2\r\n??#???..?.??? 1,1,1,2\r\n#???????#?#?????# 1,1,11\r\n?##??????#?.??? 4,1,1,1,1\r\n?..??#???#????.?### 9,4\r\n?????????????#??.?? 1,1,1,4,2,1\r\n??#.#.??????.????? 2,1,1,1,4\r\n?.....?????? 1,1\r\n#???.??##? 3,2\r\n???.???.?#? 1,3,1\r\n??.???.??..? 1,1,2,1\r\n#??#???#?#??##??? 4,4,2,1\r\n.????????. 1,3\r\n.#?????.???#? 2,1,2\r\n?.?.???#..?. 1,2,1,1\r\n?###????#.??????? 7,1,1,1,2\r\n?##?#????###??.?. 6,3\r\n???#?.?#??. 3,1\r\n??#???#?.?.? 6,1,1\r\n?.??????????? 6,1\r\n...???##???.?. 5,2,1\r\n???.???.?.???## 1,1,1,1,3\r\n???.?##??#? 1,2,1\r\n###???.?#??#?? 6,5\r\n...?#???.??????#? 3,2\r\n??????#?????????? 8,2\r\n.?????#??#.??.#? 1,5,1,1,1\r\n###???#??#??????? 4,4,1\r\n.????###?# 1,3,1\r\n??#????#?#?.??? 1,3,1,1,2\r\n.#???#?##??#?#?# 1,12\r\n##.???#??.??..# 2,1,1,1,1\r\n???#.##???? 1,3,1\r\n???###???.?.##??.?# 1,7,1,2,1,1\r\n?.#.?#?#?..?..? 1,1,4,1\r\n???.??.?#?? 1,3\r\n??????#???#. 1,3,1,1\r\n?????#.#????#??? 5,4,1,1\r\n.?.????#???. 2,3\r\n???.??.?## 3,3\r\n?????#?.????#?#? 5,6\r\n???#?.???#?? 2,6\r\n...?????#.? 1,3\r\n#???#????#? 1,2,1\r\n??##????????###??. 6,1,4\r\n??#????#??? 1,3\r\n??#???#??????#?#? 7,7\r\n??####.?.?? 6,1,1\r\n.?.?.#?#??.?????? 4,2\r\n#???..#???.?? 4,3,1\r\n??..?#??#???##? 1,6,3\r\n??????#?#? 1,1,4\r\n?.???#?.???????? 1,3,2,1,1\r\n????????##????? 1,5,1\r\n????#?#?#???#.?.#? 11,1,1\r\n?????#??##??????# 1,3,3,3\r\n?.???.?#.????#?#??# 1,1,1,1,8\r\n.#?#??????#?????. 5,3,2\r\n.??###?????#??. 3,2,3\r\n?????#?##??#??? 1,1,1,2,4\r\n??#?.#..????#?.?#? 3,1,6,2\r\n?##??.????? 2,3\r\n?????#?###??#? 2,8\r\n.??#?#??.????.? 6,2,1\r\n????#?.?#???##??? 1,2,6,2\r\n??????..?#..? 2,1\r\n?.?????#???????? 1,4,2,1\r\n#.??????.?????#? 1,2,2,6\r\n#?.?.??#?.????? 2,1,1,2,3\r\n?.????#???#??????.#? 12,1\r\n?#????#??#.???#.##? 7,1,1,1,2\r\n?#???#????????.?? 5,2,4,1\r\n???????????# 3,1,1,3\r\n.???????.? 2,1,1\r\n?#????#???????? 2,1,3,1\r\n.##.?#??.#.?# 2,1,1,1\r\n??#???#???.????. 5,1,1,1\r\n..????..?????? 1,3\r\n#??#??#????.?.# 5,1,2,1,1\r\n??#.?#????.. 2,3,1\r\n?#.??????? 2,1,1\r\n????.?#???#?? 1,2,6\r\n????#?#?..?#? 4,1\r\n??#?#????#?#????. 8,7";
            string demo2 = ".??#.#??#. 1,2";
            string demo3 = ".??? 2";
            var temp = input.Split("\r\n");

            double sum = 0;

            //To unfold the records, on each row, replace the list of spring conditions with five copies of itself(separated by ?)
            //and replace the list of contiguous groups of damaged springs with five copies of itself(separated by,).

            //So, this row:

            //.# 1

            //Would become:

            //.#?.#?.#?.#?.# 1,1,1,1,1

            Console.WriteLine("\nCalculating..");
            var start = DateTime.Now.Ticks;


            foreach (var row in temp)
            {
                double rowOptions = 0;

                string trimmedRow = row.Split(' ')[0];
                var ranges = row.Split(' ')[1].Split(',');

                string tempRow = "";
                var tempRanges = new List<string>();

                for (int i = 0; i < 5; i++)
                {
                    tempRow += trimmedRow;
                    tempRanges.AddRange(ranges.ToList());

                    if (i < 4)
                    {
                        tempRow += '?';
                    }

                }

                //trimmedRow = tempRow.Trim('.');
                //ranges = tempRanges.ToArray();

                int rowWidth = trimmedRow.Length;


                long checkOff = Convert.ToInt64(trimmedRow.Replace('.', '0').Replace('?', '1').Replace('#', '1'), 2);
                long checkOn = Convert.ToInt64(trimmedRow.Replace('.', '0').Replace('?', '0').Replace('#', '1'), 2);



                //List<int> ranges = new List<int>();
                //foreach (var range in row.Split(' ')[1].Split(','))
                //{
                //    ranges.Add(Convert.ToInt32(range));
                //}
                string toMatch = "";

                toMatch += "^0*1{" + ranges[0] + "}";

                for (long i = 1; i < ranges.Length; i++)
                {
                    toMatch += "0+";
                    toMatch += "1{" + ranges[i] + "}";
                }

                toMatch += "0*$";

                // ^0*1{2}0+1{1}0*$

                for (long i = 0; i < Math.Pow(2, rowWidth); i++)
                {
                    if ((checkOn & i) == checkOn && (checkOff | i) == checkOff && Regex.Match(Convert.ToString(i, 2).PadLeft(rowWidth, '0'), toMatch).Success )
                    {
                        rowOptions++;
                    }
                }
                sum += rowOptions;
            }




            var end = DateTime.Now.Ticks;
            var position = Console.GetCursorPosition();
            Console.SetCursorPosition(0, position.Top - 1);
            Console.WriteLine("Calculated.  ");
            Console.WriteLine("IN: " + (end - start));
            Console.WriteLine(sum);

            // 7260

            // IN:
            // 35656041
            // 37063344
            // 37065287
            // 203856858

        }
        static void Part2BrFo()
        {
            string demo = "???.### 1,1,3\r\n.??..??...?##. 1,1,3\r\n?#?#?#?#?#?#?#? 1,3,1,6\r\n????.#...#... 4,1,1\r\n????.######..#####. 1,6,5\r\n?###???????? 3,2,1";
            string input = ".??.?#??##???. 1,6\r\n?#???.#??#?????.? 3,1,3,1,1\r\n??#????#??#???.?? 4,7,1\r\n??#?.?#?#???#?#?? 1,11\r\n?????????? 1,4,1\r\n?#?#????..?????? 6,4\r\n?#?#?.#?#???????..? 5,1,1,3,2,1\r\n?.#??#??.??????.? 6,1,1,1\r\n##???###?.##?? 2,4,2\r\n???.#??#????.??? 3,7,2\r\n????#??..?# 1,3,1\r\n.?..#????????#????? 1,5,6\r\n?#..??##??.??? 1,5,2\r\n?#???#???# 1,1,2\r\n#???#??..?????.??.?. 5,1,1,1,2,1\r\n??#??.?#??????. 2,2,1,1,1\r\n??????.???..??#?? 1,2,1,4\r\n.?#??#???#??#?????. 12,3\r\n??#???#?.?##?.?? 6,3\r\n?#?#?.??#???? 3,1,1,1\r\n??#???.#??.#. 3,2,1\r\n??#...??.. 3,2\r\n#?#.??????#.??????? 3,2,1,1,7\r\n?#?#.?????#???? 3,5\r\n?#??.???.?.?.???? 4,1,1,3\r\n????????.##?#.???? 2,1,4,2\r\n?#??#.??????????#? 4,3,1,3\r\n.#?#?.???..? 3,1,1,1\r\n?..##.???#????. 2,2,2\r\n.#??#?#??#?.? 9,1\r\n???.??..?#??#?? 1,1,2,1,1\r\n.??#??#..#????? 2,1,1,2\r\n.???#??..??????####? 4,2,7\r\n????#?.??. 1,1,2\r\n?#??#?#?..???#?.?.?# 1,5,1,1,1,2\r\n??????#???.?.??.?#?? 10,1,2,1,1\r\n???.????..? 2,1,2\r\n??.#???????? 1,1,4\r\n??.??#???.?????#? 1,1,1,1,6\r\n?..????##.##?#?????? 6,6,2\r\n##???#?.??#.???? 7,2,3\r\n????#??#??#? 1,6,2\r\n.???.??..#..?#??? 1,1,1,1\r\n?.???.?.???????? 1,1,1,3,4\r\n?.?????#?#.?????#??# 7,1,5\r\n?????##?#?? 2,6\r\n???.#?#????#. 1,5,2\r\n????...?#?? 1,2\r\n.????.?????#. 2,3\r\n?.?????##??###?##??# 1,1,11,2\r\n#??..?#?.???#??. 2,1,3\r\n#?.???????#???#. 2,1,1,1,3\r\n?#???..#?? 5,3\r\n????#???#.?#???#?.#? 2,2,1,1,4,2\r\n.????#??##???#?#. 8,4\r\n???????????#?.??#. 2,1,4,1,1\r\n?.#?#??.??####??? 5,8\r\n?#?#?#???.#.?#. 8,1,1\r\n?.??.????#?.??.? 1,5,2\r\n#??.?#...? 1,1,1\r\n??#?#???#??#.????.?# 8,2,4,1\r\n.?#?####??? 7,2\r\n???#??#?.??? 4,3\r\n..????##????????.? 8,2,1\r\n???#?#?##?.???.? 7,2\r\n?#???#?#.?.??#.?. 6,1,1,3,1\r\n???.?#?.?? 1,1,1\r\n???????#..# 4,2,1\r\n?.?#.?????? 1,1,2\r\n.????????#???##?#? 4,1,4,4\r\n???#?#?????#?#?? 1,13\r\n#????#????.#?#???#? 2,5,8\r\n.????#.#??. 4,2\r\n??#????#??? 8,1\r\n?.##.??#??? 2,4\r\n#????#?#?#?.?????#? 1,1,1,4,1,3\r\n????#????.?????##??? 2,5,1,1,2,1\r\n..???#??..?#? 6,2\r\n?#?.?.##???????? 3,1,2,4,1\r\n.?.???##?????# 1,5,1,1\r\n?.#????.??? 2,1,1\r\n?#?#?#.???..???.??? 5,1,3,3\r\n.?.???#??#?.???#? 1,6,4\r\n?#???.?#?#.????#? 5,4,1,2\r\n.?#????????...#??? 2,2,4,4\r\n?????.???#? 1,4\r\n????#?.????.?#??.??? 5,1,2,1,3\r\n????????.? 2,2\r\n..??#???#?#.?#? 9,1\r\n????????#????#????? 5,3,1,1\r\n#?????#??????. 1,1,3,1\r\n?..#?.#???? 2,4\r\n..#?????????#?#???? 1,13\r\n?.?#.???#?? 1,2\r\n#?.#??????????#? 1,2,1,2,3\r\n.???????.?#.?? 1,3,2,1\r\n.????.?#?????##?? 3,3\r\n????###?##??.??#???? 1,8,5\r\n#?.?####????.? 2,6,1,1\r\n??.##???#?????? 1,6,2\r\n??.??#???#?#? 1,3,1,4\r\n.??.???.?#?#??? 1,2,5\r\n??.#.?#???.##??? 2,1,1,1,5\r\n???.???.??.?????#? 1,1,1,1,3,2\r\n?#?.?#?##???#???#??? 1,11,2\r\n??#????.?. 1,1\r\n.?#??##??#???.?? 10,1,2\r\n?#?#?.?#.? 1,1,2\r\n????#???????#. 3,1,1,1\r\n.??#?..??.???.??? 3,1,2,1,1\r\n.?#??.???#? 2,1,1\r\n?.?#.??##?????????? 1,1,8,1,1\r\n?.?????.??#?? 4,1,1\r\n?.??.#???? 1,4\r\n???#???..???.? 2,1\r\n.??????#?#??.?.? 2,5,1,1\r\n#??#??..?.?.???.#?? 6,1,1,3\r\n.???.?#?#??.??#???? 3,1\r\n.??#?..???? 4,2\r\n?.##???#???#??#.?? 2,8,1\r\n????#.#.???.???# 1,1,1,2,4\r\n#???????????.???#.? 6,1,3,1,1\r\n?#?????.??##??. 1,1,1,1,2\r\n?..????..?#? 1,1,1,3\r\n.??..????.?#?? 2,1,1,3\r\n????????????. 1,1,7\r\n???.?.??????#.?? 1,1,1,3,1\r\n?##...?..##??. 2,3\r\n.???##?????? 1,5,1\r\n.??#?.??????#???#?? 4,7\r\n.?#???.?.?? 4,1\r\n.???###???#??..???? 8,1\r\n???.?????#??##?.. 3,5\r\n??##??#??????? 5,2\r\n.?.???.#..? 1,1\r\n??##.??#??#???. 4,6\r\n?#????#..##?#? 1,3,4\r\n.?.?.??..? 1,1,1\r\n??????????#??#. 1,1,1,1,2\r\n??##???.???.????. 1,5,3,1,1\r\n???????.?????#?##??? 7,9\r\n##..#???.?#???#?? 2,1,1,4,2\r\n????#??#??????? 8,1,2\r\n.##?##???????.???# 7,1,2,1,1\r\n#.?..????#?#. 1,1,1,5\r\n???#??#????.??? 2,1,1,1,1\r\n#.??#.???#?##?#????? 1,1,1,3,4,2\r\n???###?#?.???.??? 6,2,1,3\r\n???#?#???????? 8,1\r\n??????.#???.?..??.? 3,1,3,1,1,1\r\n???#?##??#?.??.#.?? 1,8,2,1,1\r\n??????##???.#??#?? 8,2,3\r\n??.??#??.??.# 2,1\r\n??#.???#??????#? 3,3,4,2\r\n#?..???????#??#???? 1,5,6,1\r\n.??####??.???. 5,2\r\n.??#???????#? 1,1,4\r\n.?????.#?#???#?# 1,1,3,1,3\r\n.??#??#???..#.?.?# 1,1,4,1,1,1\r\n??.??????????.? 2,2,3,1\r\n???#.?.???##?## 4,8\r\n.?###??????#??#??? 5,7,1\r\n??.???.??#????#??? 2,2,1,1,5\r\n#???????.?#.#???### 3,1,2,1,3\r\n.????#???..?.#?? 4,1\r\n???????????.?#.?? 3,2,4,1,2\r\n.??#.#?.?.??##?.? 3,2,1,4\r\n??#??.?##???#? 2,3,2\r\n?????###?.? 2,5,1\r\n#?#.?##????#???? 1,1,3,1,5\r\n???#??#????????## 9,2\r\n?#??##??##???##??.?? 2,11,1,1\r\n???.?#.???? 1,1,1\r\n#???#????????.#? 1,4,1,2,1\r\n?#??.??##? 2,4\r\n.###??#??#??#?# 3,10\r\n#.????#?#??????#?? 1,2,4,2,2\r\n??..????.? 1,1,1\r\n#??##?..??????? 5,1,1,1\r\n##????.?.##???. 3,1,5\r\n???##.????#? 5,1,3\r\n?.????.##.? 1,2,2\r\n?#????##??????##???? 1,2,3,8,1\r\n???#?????.?..? 3,1\r\n?#?#??.#??#?.? 5,4\r\n??.?###??????? 1,4,1,1\r\n..##????#???#???? 4,6,3\r\n?????#??????.???# 7,3,1,1\r\n??#???????. 3,1,1\r\n??????##??????. 1,1,2,1,1\r\n?????.??????. 1,1,2,1\r\n?.?.??.?#?????#?##.# 1,1,1,8,2,1\r\n?.#???????#?? 2,1,3,1\r\n.#????..??#?..?# 4,1,1\r\n.??.??#??? 1,1,1\r\n##??###??.??? 8,1\r\n????#???????.????? 6,1,1\r\n#?#??#??..????? 1,2,1,1,5\r\n.?#????.?.??#? 6,1,1,2\r\n????..?##.?.?.????#? 4,3,1,1,1,3\r\n.#???????##??.???#?# 5,6,4\r\n##??????#?..#??? 2,1,5,1,1\r\n#????????#?#.#?.? 1,1,1,4,1\r\n#??#???#.?????#???? 8,1,1,5\r\n#?.?#??#?.? 1,2,2\r\n?.#?#??.?????..? 4,3\r\n?#?#???.?? 4,1,1\r\n???????#????#???.? 1,2,2,2,4,1\r\n????#??..?.??#?#?. 5,3\r\n..??#?#????????#???. 5,1,3,1,1\r\n?.#???.???. 1,2\r\n??????????.?.??? 6,1,1,1,1\r\n?#??????.? 3,2,1\r\n.?.##???## 1,7\r\n?.?????#??##??##???? 1,16\r\n??#????##?#??? 1,1,7,1\r\n.?????????? 5,1\r\n??????????.? 2,1,1,1\r\n##?.?????. 3,1\r\n?#?..?.???? 2,1,1\r\n#..???#??#???# 1,2,8\r\n??##?????#????? 3,9\r\n???#?.?##. 3,3\r\n??.??#?#??##?#.# 9,1,1\r\n#.??#?#??. 1,3\r\n.??#????????????? 3,1,2,3\r\n??#??#???.?.?? 7,1\r\n??#..##????#??#????? 2,10,2\r\n#?###????##?..??? 11,2\r\n.???#.??#.?##.?? 1,1,1,3,1\r\n?#??????#? 5,1,1\r\n?.?##??#??????? 5,4\r\n.?????.?#??.. 2,2\r\n.??.?#####?????##? 7,4\r\n??????.#?.. 1,1,2\r\n??#??????..?? 3,1,2\r\n??????????# 4,2\r\n?.?######???. 1,7,1\r\n????#?????????# 10,2\r\n.???#?#?#? 1,2,4\r\n?##????.???#?#?? 5,5\r\n.??#??.?#?#?.##? 1,4,2\r\n#.????????#????. 1,6,2,1\r\n?###????.?#?#??#??.? 6,9,1\r\n?..??..??###. 1,2,5\r\n?????#?????????.??. 1,1,3,6,2\r\n?.?#??.??? 1,1,2\r\n.??.?????????. 1,5,1,1\r\n????#??.?????## 3,6\r\n##?#??.?????. 4,1,1,2\r\n??#????#??.????#?. 8,1,2\r\n.???????#.?.?#??#??? 1,2,2,1,7\r\n?#.#???.?#?????# 1,1,1,1,5\r\n??#?##?.??# 6,3\r\n??????.##??#??###? 1,1,1,5,4\r\n???#???????##??. 2,1,1,2,1\r\n?????#..????#??##? 6,1,3,3\r\n????#??#??#??????##? 11,3\r\n.##??##?????.#?#?? 11,1,1,1\r\n?.?#?.?????.?? 3,4\r\n###?.????#?? 3,1,3\r\n????..?##?.??????#?? 3,2,9\r\n?#?.???#??#. 2,1,4\r\n??##?#?.#.???#??? 6,1,1,1,1\r\n#??????.???.#?#??. 4,2,1,1,3\r\n.?#???????.##? 7,2\r\n???#???.?.?#?#?. 4,1,5\r\n?.?????#.??#???# 6,3,1\r\n.??#??#??.?#??? 6,1,1\r\n??#????????. 5,1\r\n????????????? 1,4,1\r\n?#??#?####?.??.?#... 10,1,2\r\n#????#??????#???.?? 1,1,4\r\n?.???.???### 1,1,1,4\r\n?####??.?.??????. 7,4\r\n#???.#?#?#?#.?#?? 2,7,2\r\n???..?.??#???. 1,1,6\r\n???????.????####??.? 4,1,10,1\r\n??.?#?????????..?.# 2,11,1\r\n???.???#??.. 1,1,3\r\n?.?#?#??#????#?? 1,2,2,3\r\n???#????.?#??. 3,1,1,1\r\n.????????? 1,1,1\r\n?.?.????##?###??.?? 1,11,1\r\n?#????.#?#??? 1,1,1,2\r\n#.?.?..#?#?#????? 1,1,3,4\r\n?#?.??..?##?##????? 3,10\r\n?????????#????.#???? 1,7,1,2,1\r\n?#????????.#?# 1,4,2,3\r\n.????????#?. 6,2\r\n?.?#.??##.#??.?#?? 1,2,1,2,1,2\r\n.?????#??.?#?? 2,3,2\r\n#?.##?..#.???????? 2,2,1,5\r\n?????.?#????? 1,1,1,3\r\n???????#?##??#??? 1,10\r\n???##?..#? 1,3,2\r\n???#???.???.?? 2,1,1\r\n#?.#..?.?? 1,1,1\r\n????#???#?. 2,6\r\n##.?.????#??.?#?## 2,1,1,1,1,5\r\n??...?#??##.#???? 2,5,1\r\n??????..?#???? 3,1,1,1\r\n?#?.?##???#?.???? 1,8,1\r\n???##?#???????.#? 5,6,1\r\n?????..?#????# 1,1,2,2\r\n?###..??#? 3,4\r\n..?#??#????# 5,3\r\n???.???#????. 1,1,6\r\n??#?.??#?.???. 1,3\r\n?..????...?.????? 4,1\r\n#.??#??#?.#??#??#?# 1,6,1,7\r\n?.????..?.?? 1,3,1,2\r\n.??#???#??????#?.?# 1,1,10,1\r\n.#.?.??#?.?.#?? 1,1,2,1\r\n?.?.??.#???#? 1,1,1,3\r\n?.???.???.?? 1,3,2,2\r\n.????.??????. 1,1,1,2\r\n?.?#??????.??#? 1,5,1,1,1\r\n?????????#. 1,2,1\r\n.?.?#??##???? 1,6,1,1\r\n?#??#??.#? 1,1,1\r\n??.???????#??#.? 2,1,1,5\r\n#?.#??.?.##..##?.?. 1,3,2,3,1\r\n????????#?.##?#? 2,1,2,5\r\n?#?????.#?#.??#? 3,1,1,1,1\r\n????#?#?????#? 2,3,4\r\n?.???????#. 1,3,1\r\n???????##?#???.????. 14,3\r\n??????#?.#?#?? 6,4\r\n?##?#.??##?.# 5,4,1\r\n#??.???###?????? 3,1,3,1,1\r\n?#?#??.???#?#??? 5,2,4\r\n.???#?.#?####. 1,1,6\r\n.???.?#?#??.# 2,1,2,1\r\n#.#??#????? 1,6,1\r\n?.??.???.. 2,1\r\n?.??.#?##.?????#???. 1,4,8\r\n.#?#?#?#???..?#??# 9,4\r\n.#.?#?#??.# 1,6,1\r\n#?#.???#?????? 3,1,7\r\n??#?###??#?#??#??? 1,6,1,1,2,1\r\n??.?##???#?#?.? 1,10\r\n.#?##???#???##???..# 1,11,1,1\r\n??.#?.????#???# 1,1,7,1\r\n#????????#? 1,6,1\r\n????.#?.??#???#.?# 1,1,1,4,1,1\r\n.???#?#??.?.???# 7,4\r\n???##??????..## 8,2,2\r\n?#?#?.?.?##?## 5,5\r\n?.?..???.. 1,2\r\n.?.????..# 1,3,1\r\n#??????#??.?#?###??? 1,1,1,1,1,8\r\n.??#??.?.???? 4,1\r\n??????##?.. 2,3\r\n?#.????.#?# 1,1,3\r\n.?????..?????#. 2,1,2\r\n????#?#?##.????? 10,1\r\n?????.????#?? 3,1,1,1\r\n.??????.??.??..? 6,1\r\n?????????#??#???# 1,2,3,5\r\n#??####??..??#?.. 9,1,2\r\n?####??##?.????? 9,1\r\n?##??#??.???#. 6,4\r\n#.#?????????.#????? 1,1,1,1,1,5\r\n??#???????###??#??? 5,8\r\n#??##?????#????#? 1,7,1,1,1\r\n????????#?.????.???. 1,1,3,1,3,3\r\n??.??????? 1,2,1\r\n.?####???.???#?.? 4,1,3\r\n.???##??#?????.???? 13,1\r\n???.??#??#?????????? 1,1,3,7\r\n?????..??.?? 1,1,1,2\r\n?#???#??#??#???.??? 7,6,1\r\n???#???#?#??????. 6,1,2,1,1\r\n???????.?????? 1,3,2,1\r\n..#???#???#????#? 1,10\r\n??##??##???.???# 6,1,1\r\n#?#???###?##?.?????? 1,1,1,7,1,1\r\n??#?.?#?.???? 1,2,2\r\n.?..???#.? 1,4\r\n#??????#.?#?.##???## 3,1,2,7\r\n...#??#??#?##??.. 10,1\r\n.#??.??????????? 3,2,1,1\r\n?#??#?#?#????###??. 2,15\r\n?#????#??.?????? 2,4,6\r\n??.??.????##. 1,1,1,4\r\n.??#???.?.?????? 4,1\r\n?#??.??##??#??.? 2,8\r\n????#?#??#???##????. 1,15\r\n.???????#..?#?? 2,4,2\r\n?.?#?#?.#.?.??? 1,2,1,1,1\r\n???????#?##?#??? 1,6,2,1,1\r\n#???#####?.???#??. 10,4\r\n??????#.?????.? 2,3,4\r\n?.?#?#?????.? 4,1\r\n?.#?#?..????????#. 1,4,1,3,1\r\n.?????????#??##?? 3,1,7,1\r\n#.?.?.???##.??? 1,1,1,2,1\r\n?#.??##??.?..#? 2,3,1,2\r\n?#.?.????????#? 1,2,6\r\n???#?.??##?#???#??. 1,2,1,10\r\n???????.?#????? 6,3,2\r\n????#?.????.??.? 1,2\r\n#???.??#.??? 1,1,3,2\r\n???.??#??#????? 1,2,3,1\r\n?#?#????#?.?? 2,1,4,1\r\n.#???????#??#? 3,1,5\r\n?#.???.#.????#? 1,2,1,5\r\n.???#???##.??????.# 6,2,1,1,1,1\r\n.??????????? 1,1,4,1\r\n..??????????#?#?#?#? 6,10\r\n???.#????#.# 1,3,1,1\r\n#???????##?#..?? 1,1,5,1,1\r\n??#???#?#?.??...??# 10,1,2\r\n?#???#??..?????#???. 7,3,2\r\n???????????#??. 1,2,1,1,1\r\n#????#???##??.?.?#.? 1,11,2\r\n?????.??.???.?# 5,1,3,1\r\n?.#?#?#?#?#?#??? 1,1,1,3,5\r\n??.????.???? 2,3\r\n???????#??#? 1,3,2,1\r\n???.??#???#? 1,4,2\r\n??.??#?#.#????? 1,1,1,2,3\r\n???#????.?????.?.??? 5,1\r\n???#?.???##???####. 2,10\r\n.??#..?.???? 2,2\r\n?#.???#??##??? 1,7\r\n?????????##?? 3,1,3\r\n.?#?#?.?.#? 4,1,2\r\n.?.?#??.????#?? 1,2,1,3\r\n?#?#?????.??#?.??? 7,3,1\r\n.#???????#????.#..?? 3,4,3,1,1\r\n?.?#.????.#??#???# 1,1,1,1,6\r\n??##??#???#?#..# 4,7,1\r\n????#????. 5,2\r\n??#?#?.?.?..??? 2,1,1,1,1\r\n##????#?##??? 2,1,1,5\r\n??#..?#?##??? 2,8\r\n?.??#??????#?? 6,2\r\n??.?.???.??? 1,1,1,1\r\n?.?????#??? 1,4\r\n??#???????#??????? 1,7,1,1,1,1\r\n????..??.?????.#?? 2,1,1,1,1,3\r\n?#?#??.???????? 2,2,6,1\r\n??.??#?????##?? 2,2\r\n???.???????????.?? 1,2\r\n??##??????#?#??.# 2,1,2,3,1\r\n??????#??#? 3,1,1\r\n??.?????##????##??? 2,14\r\n?#?.?..??? 1,3\r\n?.??????#? 2,1,1\r\n??.??##.?? 2,2,1\r\n.??.??.??? 1,1\r\n.?#????#??. 2,3\r\n???????#???.#? 3,2,1\r\n??#???..?? 6,1\r\n...?#???###????? 2,4\r\n#?.?.???????? 1,1,1,2\r\n?????#????#??.?? 7,2\r\n.?????#??.???????? 4,3\r\n?###??.?.?.?##??#?? 3,1,1,7\r\n??#?#?##??...??? 9,1\r\n?????#?#?????.?##? 12,3\r\n???????????..#??. 8,3\r\n?#??#?##???#??? 7,1\r\n??????###??## 1,10\r\n?#??????#????#####.? 2,2,1,8,1\r\n.?###???..??#???.? 4,1,3\r\n?.???????? 1,6\r\n???#??#.??#?##??.? 4,2,7\r\n??.#??#??##??#?##. 2,2,11\r\n??.??#?#... 1,4\r\n.?.#?#?.?????#? 1,4,5\r\n.?????.???#?#?#??#? 4,9\r\n??.#?????#?#????? 1,12,1\r\n???#???#????.#???? 1,7,1,1,1,1\r\n??.?????##?.?..#?#.# 1,1,3,1,3,1\r\n.?#??##?????###?# 1,7,3,1\r\n#???????????#????#?? 1,2,1,1,1,7\r\n####??##???#??. 9,4\r\n???#???#?.??#? 4,3,1,2\r\n???..#???? 1,1,1\r\n?#????#?.????.??#? 3,1,1,2,1\r\n.?#????##? 4,4\r\n??.???.??? 1,2,1\r\n.??##??.????#??? 3,1,8\r\n????????#? 1,4\r\n.#????#???????.?.? 6,1,2,1\r\n??.??????##??#?#?#? 1,1,8,3\r\n??????###? 1,3\r\n???#..#??#.??.?#? 4,1,2,1,1\r\n?.##??#????..##?? 7,2\r\n#??#????#?? 5,2\r\n.#??.?#?#???? 2,3\r\n?.??#??##?????.??#? 3,2,2,3\r\n?.#???##????.? 10,1\r\n.##???.#??? 5,2\r\n??#?????.?#.???.?# 2,2,1,1,3,1\r\n?#?????.#??#???#???? 1,10\r\n?##?#..???#??#??#??? 3,1,1,6,1,1\r\n?.?????#?????????.. 2,3\r\n????#??#????#???. 1,12\r\n.#?????#????????###? 1,11,3\r\n#?#??.??###?? 3,1,3\r\n.#?????.??##???#??? 3,10\r\n.#?.??#??? 2,1,1\r\n.???##?..?. 5,1\r\n?.??#??.???? 2,1,2\r\n?.??.#?.????#?????# 1,1,2,1,9\r\n.??????#?#????.?#?. 8,1,3\r\n?##???????.#. 3,3,1\r\n#???????#.???? 9,3\r\n?#???.##??#??? 4,7\r\n????.?#??.?.#?#??? 2,4,5\r\n.?????#?#??#?????# 7,1,1,1\r\n#??..???#??#? 3,4\r\n???.??##?????##??#?# 3,7\r\n?#?#.??.?#.?#.? 1,1,1,1,1\r\n#.??????????? 1,4,3\r\n...???????##??#??#.. 1,12\r\n.???###????#??##???# 1,15,1\r\n???.?.?#?##..#? 3,5,2\r\n..??????.??#??. 2,2,4\r\n##???#?#?????? 8,3\r\n???.???#??? 1,4\r\n???.??.?#?????.#???? 2,1,3,2,1,1\r\n???#?#??#.? 1,6,1\r\n??###?????#?##.???# 10,2,1,1\r\n???##???..#??? 4,2\r\n?##??#.?#?##? 5,5\r\n??????.?#.?.?.? 1,1,2,1,1\r\n???.?#?#?.?.? 1,1,2,1\r\n???.??#?.?? 1,2,1\r\n?#????.?#.??? 5,1,1\r\n?.???.??#? 2,2\r\n??.??#??????#????##? 1,16\r\n????.????.??.?.#?#?? 1,4,1,1,1,1\r\n.??#??????? 1,3\r\n???.?????.. 1,1,3\r\n#??#?..???#?..?? 4,1,2,1\r\n??????#.????? 7,1,2\r\n?###???..?#?? 6,2\r\n?????????#??#.?? 1,1,4\r\n.????#????. 4,2\r\n.?#.?..??#.?##??# 2,1,2,2,1\r\n#?#?????#??#?.?#.#? 6,1,2,1,1\r\n????.#???#???? 2,1,2,1\r\n???#????????..#?? 8,2\r\n??##?#???.?#?..???. 6,3,2\r\n????.??#??#.?#??? 4,6,3\r\n???##??##?? 5,3\r\n???????.#..#???# 3,1,1,1,3\r\n?????????? 2,1,1\r\n#??#????#?#?????#? 11,1,3\r\n#??#??#?.???##??? 1,2,2,7\r\n#?.???#?##?##?? 2,1,9\r\n..??..??..?? 1,2\r\n.????.?#?#?.?. 4,5\r\n#???#??#???.???#??? 2,4,1,1,1,1\r\n.??#..??????#???#?. 3,1,9\r\n#???????#.????? 2,1,1,2,1\r\n??????##????#??.??. 8,1\r\n???.??#?...?#?#? 3,4\r\n?.??.#??#? 1,1,4\r\n?.??#?#??.??? 1,4,2\r\n?##??#??.????.??? 6,1,4,1\r\n??.?????#??? 1,3,1,1\r\n?.?????????#?#??? 5,8\r\n?.?????.#?##?. 1,1,1,4\r\n.?????##?#??.? 11,1\r\n.?.??#?????????# 1,1,1,5\r\n#?#????..?#??#??? 6,5,2\r\n?#??#??#?#?.???#??? 10,2,1\r\n.??????#.? 4,1,1\r\n????.?#.????? 2,1,4\r\n???????.?##? 2,4\r\n?#????#???? 4,4\r\n?.?#.???.?## 2,1,3\r\n?.????#...???..??. 4,1,1\r\n?#???#????#. 8,1\r\n?#.??????.?####?. 2,2,2,5\r\n??#?????#.?? 5,3,1\r\n?#????#??????#..?# 7,4,1,1\r\n#?????.???#?##?? 1,1,1,2,4\r\n##?#????.???. 8,1\r\n?.???????##??? 3,6\r\n???????##??#???. 1,7,1,1\r\n#?????#?.??##??????# 1,5,7,3\r\n.???????.# 2,1,1\r\n??????.?#?? 3,2,3\r\n??????#????. 7,1\r\n??#?.??.??? 3,2\r\n..??????#?#???#.? 9,1\r\n##?#??..#.? 5,1,1\r\n?#??#.????.???? 4,1,1,1,1\r\n?????#.#.?.??? 2,1,1,2\r\n???###?..??. 4,1\r\n??####?#?????#? 7,1,1\r\n??###?#???.#???????? 9,1,2,2\r\n??.??.?..####?#??? 1,6\r\n.???#?????????????# 3,2,1,1,1\r\n??#.????.????????? 2,3,5,1\r\n.?..?#?#??????#??. 1,10,1\r\n#?.???#..???. 1,4\r\n?#????????#?.. 5,5\r\n???#.#??#?##???##. 3,7,4\r\n.??###?#?.?????..?? 6,4\r\n???.???##???.??# 3,1,5,1,1\r\n..????.???? 2,1\r\n?#..?##??.#??#? 1,4,2,2\r\n????..??#?#?? 1,1,2,3\r\n#???.???????? 2,4\r\n..??????#??.???.??? 7,2,1\r\n?.#???????.. 3,2\r\n??????##????? 9,2\r\n??.#.??.?#???#?# 1,1,3,3\r\n????.#.???? 3,1,1\r\n#??.?##??#??#.?? 1,1,9,1\r\n?.????..??.???? 1,3,1,1,2\r\n??.???##??.#????? 1,5,4,1\r\n???.??.?????.?.???# 3,1,2,1,1,4\r\n?#.#???..??#??#? 2,1,1,4,2\r\n?.??.?..?????.???. 1,1,1,5,1\r\n.?#???.??.????????? 4,1,1,3,1,1\r\n???.?#.???. 2,1,3\r\n???.?#??????# 1,3,1,2\r\n????????.?????. 5,4\r\n??#.??.??? 1,1,3\r\n??#?..?#???#?.? 3,4,2\r\n????#??##???????? 7,1\r\n#??????##?.## 1,1,3,2\r\n???#.?????# 3,4,1\r\n#?#?.??????# 1,2,3,1\r\n?.??#..#..?? 2,1\r\n?????????.?????..? 7,1,1,1\r\n?????.???.??#??.??# 2,1,1,1,3,2\r\n?.?.??#?.#?# 1,1,1,3\r\n????????#.? 6,1\r\n#.????##???????? 1,5,3,1\r\n..???#.?.#?#??#??# 4,1,4,1,2\r\n.?.#?.??.??? 1,2,1,2\r\n??#??.?#???.. 2,3\r\n???#??#????#? 7,2\r\n??##?.??#? 3,4\r\n?.????#????.#?#? 1,2,3\r\n.???.???#?#????? 2,5,1\r\n.##.??.#.##? 2,1,1,2\r\n??????#??????##?.? 1,4,3,4,1\r\n???????#???.?#?# 6,4\r\n??..?????????.#??#. 1,8,1,2\r\n????????.? 1,2,1\r\n??##??##???#?.??#??? 3,6,6\r\n.??#?#???????? 3,2\r\n.??????.??##???..? 5,4\r\n????????..? 2,4,1\r\n.#?????#?#??????? 1,9,2\r\n?#####??#???.#?? 7,1,1,1\r\n#???.?#.#.?#?#?###?? 1,2,1,1,8\r\n.?#?????.??????? 6,4\r\n????.?.??##.????#?. 2,1,3,1,2\r\n???????????????#. 5,1,4\r\n.?..?.?##????? 1,1,4,2\r\n..???????? 2,2\r\n??.??#?#.? 1,5\r\n?#???.#####??? 3,5\r\n??..#?#?#???#??? 1,3,8\r\n.????????.???#? 2,1,1,1,2\r\n?????.#???????#.#. 1,2,1,2,1,1\r\n????#???#??#.?? 6,5\r\n??.?#??#??#?.??#?#?? 5,2,4\r\n???###??#?#????. 8,5\r\n.??????##.????#??.# 1,5,1,3,1,1\r\n.?????..?????? 1,1\r\n??##?.?.?? 3,1,1\r\n???#??###??????##??? 1,6,8\r\n.????#.???????.?#?#? 1,1,1,6,1,1\r\n???#..?#.?.?? 4,2,1\r\n?.?.#.?#?## 1,1,5\r\n?#???.?#?? 4,2,1\r\n?#?#?#???#?.??#.??# 5,2,1,1,1\r\n.???#?.?##?? 1,5\r\n?#???.?#.? 4,1\r\n.##??#?#...?? 7,1\r\n?##?.?.?.?#?..??. 2,3\r\n??#?#.??#?????? 4,2,2\r\n?#?###?.????.? 7,1,2\r\n#?.#?#?.?#?.#? 1,4,1,1\r\n...#?#???.???? 4,1\r\n.#?????#.?##??? 1,1,3,3,1\r\n.??#????###?????? 3,8,1\r\n?.???#??????????#??? 4,9\r\n.##?????#?? 5,1\r\n??.????#?????.?.. 1,10,1\r\n.??#?#?????..#.?.??? 2,3,1,1,1,2\r\n??????#???? 2,3,2\r\n??#??????#?????# 6,1,1,4\r\n???????.?#.??#?# 2,2,2,1,1\r\n?#.????#?? 2,6\r\n??#????????.. 5,1,2\r\n?????#????#??#?.?#?. 8,5,3\r\n??##????#?..? 5,3\r\n.?????.????#? 3,4\r\n...?.?????????#???. 1,8\r\n#?????#??.. 7,1\r\n.??#????????? 4,1,1,1\r\n?#.??????.???? 2,1,2,1\r\n#???#?#?#?????????? 9,1,1,1,1\r\n??.?.??..??#.?# 2,1,1,3,2\r\n?#?#??#???#.????.?? 10,1,2,1\r\n.???#.?????.? 3,3\r\n???#??##??.????#??#? 8,1,1,1,1\r\n????..??????#?? 1,2,2\r\n?#.?.?#..#??#?.? 2,1,1,5\r\n????###.#..? 1,4,1\r\n.????????? 1,1,1\r\n?.?...????? 1,2\r\n??#??.??##?? 3,6\r\n?.????#??#?.#?? 1,9,2\r\n?###??????#.???. 11,1,1\r\n?????#.?????? 3,1,1,1\r\n?.##..?????.?#..?? 2,1,2\r\n??#??#?????..? 4,1,1\r\n?##?#?#??.??#. 5,3,3\r\n.??.#????#???#???? 2,1,7,2\r\n?.#???????????????? 1,1,9,3\r\n.???#????##.? 1,2,2,1\r\n?#?.?.???#??#?..?.?? 1,1,6,1,2\r\n??#?????????#??? 4,1\r\n??????.??###?????.#. 3,1,1,3,4,1\r\n?????#.#.?.?#? 5,1,1\r\n????####..?#..#?# 7,2,1,1\r\n#???..??????...#?? 2,1,6,1,1\r\n?????#??.? 5,1\r\n.??#????#? 4,1\r\n???.#???.??#? 4,2\r\n.#????#??#?????? 3,3,1,2\r\n?????.??????.???? 1,1,3,1,2\r\n?#.##?#?.#####??# 1,4,8\r\n??.#????...?### 1,1,1,4\r\n#??#?#??#?.? 6,2,1\r\n????#???#?? 5,1\r\n#???#?#????##.?.? 13,1\r\n?###????#???. 4,6\r\n????????##???????. 1,4,2\r\n#?.????#.???? 1,1,2,2\r\n.????????#? 1,2,3\r\n?????##?#.??##?. 8,4\r\n?#??#?#????? 1,1,1,1\r\n????#??#?#? 1,5\r\n#??????#?#??????#??# 4,8,3,1\r\n?.?###??.????????? 3,7\r\n??#???#?????.?###?? 1,1,2,1,4,1\r\n?.??..?.??.????##.?? 2,1,1,6,1\r\n??#??????? 1,5\r\n???##??##???.#??#?# 8,1,6\r\n.?.??#?##?#?? 6,1\r\n????????##????#?# 1,1,9,1\r\n????.#?##?.?? 3,5,1\r\n??#??.????..?. 4,3,1\r\n#??#??????#??? 1,1,1,3\r\n###?#.?..#? 5,1,1\r\n?????#.??????#?#? 1,2,1,5\r\n#.???#??#. 1,3,1\r\n.??#?##????? 6,1\r\n?????#????..?? 7,1\r\n???#??#?#??#??.??? 1,2,3,2,3\r\n??????..#????#??.? 2,1,1,2,4,1\r\n?#.##?##??????.? 1,5,1,3,1\r\n??#??##????.????# 8,1,1\r\n???????#.#??#? 1,3,2,1\r\n?##?.?#???#???????? 2,2,3,2,1\r\n.#??..??.????#? 3,2,1,1\r\n???????.??????#.###. 3,3,1,5,3\r\n??#.#??#????. 2,4,3\r\n#.#??#????#??##????? 1,1,2,1,6,3\r\n##?#?.#?#.#.??? 5,1,1,1,1\r\n??????????##??#.?# 5,2,2,2,2\r\n??#.??#?????#?#?? 2,7,4\r\n???.???????.??#? 1,3,2,3\r\n?#.#??...?#.# 1,1,2,1\r\n???#?????#?#???#..## 3,9,2\r\n#.???????#. 1,7\r\n.??#????.?.????.?? 2,2,1,1,1,1\r\n?????..??. 1,1,1\r\n??#.???????#.? 2,5,1\r\n?????????? 3,1,3\r\n#.?.??##??.? 1,1,4,1\r\n??.????????#????? 1,2,3,1,3\r\n.#####????????? 6,1,2\r\n##????##?.?#.??? 9,1,2\r\n??#??????? 2,1,1\r\n????#?????????.?#. 14,1\r\n?##???##?.##??. 7,4\r\n#.?#?##??#?####???# 1,14,1\r\n.?##?.?????# 4,1,2\r\n.?#.#?.???# 1,1,2\r\n.?..???????#?.?# 1,1,6,2\r\n??##?#?????##??.???? 6,2,3,2\r\n??#??????.??#?? 7,2\r\n#.?.?..#?.??#?#?#. 1,1,1,1,5,1\r\n?.?#???????? 2,4\r\n????#??..???#?#?. 1,4,1,1,1\r\n???.?????# 2,6\r\n???#???##..?????..?? 2,3,3,1\r\n??##?##?#???###? 5,7\r\n.??#??##??#?. 2,5\r\n.#???#?#?????# 1,11\r\n?#?#?.?????.????#?? 2,1,2,1,7\r\n??#?????????# 3,1,1,1\r\n.??.????#? 2,2,1\r\n????????#????? 1,7\r\n?????.##???#?#? 1,3,3\r\n????#..??#??? 1,1,2\r\n?#?.?.#???# 2,2,1\r\n#..??.??????#. 1,2,1,4\r\n.##?.??#.?#.?? 2,3,1,1\r\n..?#???#???###.????? 12,1\r\n????.????#? 2,1\r\n???#.?.??? 1,1,1\r\n.??.????.# 1,1,1\r\n????.???.?.???##??? 3,1,6\r\n??#????.??.? 4,1\r\n#.?..###?? 1,1,5\r\n?????????..#.? 1,3,1,1\r\n???.###?#??.?. 1,6,1\r\n????????????#?##???? 3,1,9\r\n??.??.???? 1,2\r\n??#?.?????.???????? 4,5,2,4\r\n????#?#.?#####??. 5,7\r\n?.#?????#??? 1,3,1\r\n#????#??.?? 1,1,1\r\n.??????.????# 3,1,2\r\n??#?#?????#?.???#### 10,6\r\n?.?????#?..? 1,4\r\n???#??.#??#??? 2,5\r\n##?#?.#?##??##?????? 4,8,3\r\n???#???.??????## 3,1,6\r\n.???#??.??. 1,3\r\n.???#?.??.?#??? 1,2,2,1\r\n??#?.??#.?#.??##??? 3,2,1,5\r\n?###??#???###?#???.? 8,8,1\r\n###?.?.???..??.? 3,1,3,1,1\r\n?#?.?.##????#???? 1,1,4,2,1\r\n???????.?? 1,4,2\r\n.?#???###??? 1,4,1\r\n#.????.???#.# 1,1,4,1\r\n??#?#????.?#?.? 1,5,1,2,1\r\n.?#?#?#?##? 4,1,3\r\n????????????#?#????? 1,1,8,1,1\r\n#.????????? 1,2,2\r\n?##??.???? 3,1,1\r\n????..???.?.###?# 2,2,5\r\n#?#????##.#?? 5,2,2\r\n???.#????##?????..#? 1,1,6,2,1\r\n.#??.??.?? 1,1,1\r\n#????#??##??? 1,2,4\r\n?#????.??????.? 5,4\r\n??.?#???#?..?# 1,5,1\r\n?#???????????#???? 4,1,5,1\r\n???????#?.? 5,1\r\n?#??#?????.#??.#?? 5,1,1,1,3\r\n???.??????.?? 3,1,2\r\n?.???.#??? 2,3\r\n?.#.?????? 1,2,1\r\n#??#.??.#???. 1,2,3\r\n#???.#.?.?#?. 1,1,1,2\r\n?##??????.?#.?? 2,4,2,1\r\n.?#??#.?#??????? 4,4,3\r\n#????.???.??#???#.? 2,1,2,4,2,1\r\n?????.?????# 1,1,5\r\n#???#.#?.?????????? 2,2,2,9\r\n?#????????.?#.#? 7,1,1,1\r\n##?.????#?.?#??. 3,4,3\r\n???##??#????#?????? 11,5\r\n.??.??#??##.?? 1,7,1\r\n#??##???#.?.? 5,2,1,1\r\n???.??#????##??.?# 2,1,1,6,1\r\n??##?#????? 3,3\r\n#.?#??.????#??# 1,3,1,1,4\r\n..##?#??.?#? 5,2\r\n??.??#????. 1,4\r\n???#?.????? 4,2\r\n#?..????.?#??#?#?#? 1,3,9\r\n????##???#.?#?? 7,1,3\r\n?????#???????.?? 1,5\r\n??.??.????##??#???? 2,10\r\n??#?###?.?# 3,3,2\r\n???????#???.??.. 7,1\r\n??????????#.#?? 4,1,1,1,2\r\n?#?#?#??#??.??##??#. 9,5,1\r\n?.##?????.? 2,4,1\r\n#.???.???#??#?#?#??? 1,1,12\r\n?.?.?#???#?#?#.?#. 1,1,1,4,1,1\r\n???#?#???##????#??? 6,4,4\r\n?.????##..??.## 1,1,3,2,2\r\n.????#.?.??? 5,1\r\n?????..?.??#.?#? 1,2,1,2,1\r\n?.??#?????.?#? 1,5,1,2\r\n.????##?????#?? 1,4,2,3\r\n??.??.???.?#?? 1,3,3\r\n?.#????.???#??.#???? 1,1,1,6,1,1\r\n..#?????????##???## 1,4,4,3\r\n###??.##??#?????. 4,2,6\r\n?..?#????.??.?? 1,2\r\n.?#?.#????????.??? 3,1,3,1,1\r\n?#?????#?##?.###?#?? 3,7,5\r\n##??##??????#??..??? 13,1,1,1\r\n..#??.?#????#??? 1,2,6\r\n?????#?#?????##?.##? 1,7,1,3,3\r\n?##?#?#?##? 6,2\r\n.??#??..???? 4,2\r\n.#?##????.???. 1,3,1,1\r\n??##??.?#.? 4,2,1\r\n???.???#?# 3,2,1\r\n.????..?##???#??#. 2,10\r\n?##?????#??.## 5,2,2\r\n??????.??? 3,2\r\n??#???..?.??? 1,1,1,2\r\n#???????#?#?????# 1,1,11\r\n?##??????#?.??? 4,1,1,1,1\r\n?..??#???#????.?### 9,4\r\n?????????????#??.?? 1,1,1,4,2,1\r\n??#.#.??????.????? 2,1,1,1,4\r\n?.....?????? 1,1\r\n#???.??##? 3,2\r\n???.???.?#? 1,3,1\r\n??.???.??..? 1,1,2,1\r\n#??#???#?#??##??? 4,4,2,1\r\n.????????. 1,3\r\n.#?????.???#? 2,1,2\r\n?.?.???#..?. 1,2,1,1\r\n?###????#.??????? 7,1,1,1,2\r\n?##?#????###??.?. 6,3\r\n???#?.?#??. 3,1\r\n??#???#?.?.? 6,1,1\r\n?.??????????? 6,1\r\n...???##???.?. 5,2,1\r\n???.???.?.???## 1,1,1,1,3\r\n???.?##??#? 1,2,1\r\n###???.?#??#?? 6,5\r\n...?#???.??????#? 3,2\r\n??????#?????????? 8,2\r\n.?????#??#.??.#? 1,5,1,1,1\r\n###???#??#??????? 4,4,1\r\n.????###?# 1,3,1\r\n??#????#?#?.??? 1,3,1,1,2\r\n.#???#?##??#?#?# 1,12\r\n##.???#??.??..# 2,1,1,1,1\r\n???#.##???? 1,3,1\r\n???###???.?.##??.?# 1,7,1,2,1,1\r\n?.#.?#?#?..?..? 1,1,4,1\r\n???.??.?#?? 1,3\r\n??????#???#. 1,3,1,1\r\n?????#.#????#??? 5,4,1,1\r\n.?.????#???. 2,3\r\n???.??.?## 3,3\r\n?????#?.????#?#? 5,6\r\n???#?.???#?? 2,6\r\n...?????#.? 1,3\r\n#???#????#? 1,2,1\r\n??##????????###??. 6,1,4\r\n??#????#??? 1,3\r\n??#???#??????#?#? 7,7\r\n??####.?.?? 6,1,1\r\n.?.?.#?#??.?????? 4,2\r\n#???..#???.?? 4,3,1\r\n??..?#??#???##? 1,6,3\r\n??????#?#? 1,1,4\r\n?.???#?.???????? 1,3,2,1,1\r\n????????##????? 1,5,1\r\n????#?#?#???#.?.#? 11,1,1\r\n?????#??##??????# 1,3,3,3\r\n?.???.?#.????#?#??# 1,1,1,1,8\r\n.#?#??????#?????. 5,3,2\r\n.??###?????#??. 3,2,3\r\n?????#?##??#??? 1,1,1,2,4\r\n??#?.#..????#?.?#? 3,1,6,2\r\n?##??.????? 2,3\r\n?????#?###??#? 2,8\r\n.??#?#??.????.? 6,2,1\r\n????#?.?#???##??? 1,2,6,2\r\n??????..?#..? 2,1\r\n?.?????#???????? 1,4,2,1\r\n#.??????.?????#? 1,2,2,6\r\n#?.?.??#?.????? 2,1,1,2,3\r\n?.????#???#??????.#? 12,1\r\n?#????#??#.???#.##? 7,1,1,1,2\r\n?#???#????????.?? 5,2,4,1\r\n???????????# 3,1,1,3\r\n.???????.? 2,1,1\r\n?#????#???????? 2,1,3,1\r\n.##.?#??.#.?# 2,1,1,1\r\n??#???#???.????. 5,1,1,1\r\n..????..?????? 1,3\r\n#??#??#????.?.# 5,1,2,1,1\r\n??#.?#????.. 2,3,1\r\n?#.??????? 2,1,1\r\n????.?#???#?? 1,2,6\r\n????#?#?..?#? 4,1\r\n??#?#????#?#????. 8,7";
            string demo2 = ".??#.#??#. 1,2";
            string demo3 = ".??? 2";
            var temp = demo.Split("\r\n");

            double sum = 0;

            //To unfold the records, on each row, replace the list of spring conditions with five copies of itself(separated by ?)
            //and replace the list of contiguous groups of damaged springs with five copies of itself(separated by,).

            //So, this row:

            //.# 1

            //Would become:

            //.#?.#?.#?.#?.# 1,1,1,1,1


            foreach (var row in temp)
            {
                double rowOptions = 0;

                string trimmedRow = row.Split(' ')[0];
                var ranges = row.Split(' ')[1].Split(',');

                string tempRow = "";
                var tempRanges = new List<string>();

                for (int i = 0; i < 5; i++)
                {
                    tempRow += trimmedRow;
                    tempRanges.AddRange(ranges.ToList());

                    if (i < 4)
                    {
                        tempRow += '?';
                    }

                }

                trimmedRow = tempRow.Trim('.');
                ranges = tempRanges.ToArray();

                int rowWidth = trimmedRow.Length;




                //List<int> ranges = new List<int>();
                //foreach (var range in row.Split(' ')[1].Split(','))
                //{
                //    ranges.Add(Convert.ToInt32(range));
                //}
                string toMatch = "";
                long checkOff = Convert.ToInt64(trimmedRow.Replace('.', '0').Replace('?', '1').Replace('#', '1'), 2);
                long checkOn = Convert.ToInt64(trimmedRow.Replace('.', '0').Replace('?', '0').Replace('#', '1'), 2);


                toMatch += "^0*1{" + ranges[0] + "}";

                for (long i = 1; i < ranges.Length; i++)
                {
                    toMatch += "0+";
                    toMatch += "1{" + ranges[i] + "}";
                }

                toMatch += "0*$";

                // ^0*1{2}0+1{1}0*$

                for (long i = 0; i < Math.Pow(2, rowWidth); i++)
                {
                    if ((checkOff | i) == checkOff && (checkOn & i) == checkOn && Regex.Match(Convert.ToString(i, 2).PadLeft(rowWidth, '0'), toMatch).Success)
                    {
                        rowOptions++;
                    }
                }
                Console.WriteLine(rowOptions);
                sum += rowOptions;

            }


            Console.WriteLine(sum);
        }
        static void Part1()
        {
            string demo = "???.### 1,1,3\r\n.??..??...?##. 1,1,3\r\n?#?#?#?#?#?#?#? 1,3,1,6\r\n????.#...#... 4,1,1\r\n????.######..#####. 1,6,5\r\n?###???????? 3,2,1";
            string input = ".??.?#??##???. 1,6\r\n?#???.#??#?????.? 3,1,3,1,1\r\n??#????#??#???.?? 4,7,1\r\n??#?.?#?#???#?#?? 1,11\r\n?????????? 1,4,1\r\n?#?#????..?????? 6,4\r\n?#?#?.#?#???????..? 5,1,1,3,2,1\r\n?.#??#??.??????.? 6,1,1,1\r\n##???###?.##?? 2,4,2\r\n???.#??#????.??? 3,7,2\r\n????#??..?# 1,3,1\r\n.?..#????????#????? 1,5,6\r\n?#..??##??.??? 1,5,2\r\n?#???#???# 1,1,2\r\n#???#??..?????.??.?. 5,1,1,1,2,1\r\n??#??.?#??????. 2,2,1,1,1\r\n??????.???..??#?? 1,2,1,4\r\n.?#??#???#??#?????. 12,3\r\n??#???#?.?##?.?? 6,3\r\n?#?#?.??#???? 3,1,1,1\r\n??#???.#??.#. 3,2,1\r\n??#...??.. 3,2\r\n#?#.??????#.??????? 3,2,1,1,7\r\n?#?#.?????#???? 3,5\r\n?#??.???.?.?.???? 4,1,1,3\r\n????????.##?#.???? 2,1,4,2\r\n?#??#.??????????#? 4,3,1,3\r\n.#?#?.???..? 3,1,1,1\r\n?..##.???#????. 2,2,2\r\n.#??#?#??#?.? 9,1\r\n???.??..?#??#?? 1,1,2,1,1\r\n.??#??#..#????? 2,1,1,2\r\n.???#??..??????####? 4,2,7\r\n????#?.??. 1,1,2\r\n?#??#?#?..???#?.?.?# 1,5,1,1,1,2\r\n??????#???.?.??.?#?? 10,1,2,1,1\r\n???.????..? 2,1,2\r\n??.#???????? 1,1,4\r\n??.??#???.?????#? 1,1,1,1,6\r\n?..????##.##?#?????? 6,6,2\r\n##???#?.??#.???? 7,2,3\r\n????#??#??#? 1,6,2\r\n.???.??..#..?#??? 1,1,1,1\r\n?.???.?.???????? 1,1,1,3,4\r\n?.?????#?#.?????#??# 7,1,5\r\n?????##?#?? 2,6\r\n???.#?#????#. 1,5,2\r\n????...?#?? 1,2\r\n.????.?????#. 2,3\r\n?.?????##??###?##??# 1,1,11,2\r\n#??..?#?.???#??. 2,1,3\r\n#?.???????#???#. 2,1,1,1,3\r\n?#???..#?? 5,3\r\n????#???#.?#???#?.#? 2,2,1,1,4,2\r\n.????#??##???#?#. 8,4\r\n???????????#?.??#. 2,1,4,1,1\r\n?.#?#??.??####??? 5,8\r\n?#?#?#???.#.?#. 8,1,1\r\n?.??.????#?.??.? 1,5,2\r\n#??.?#...? 1,1,1\r\n??#?#???#??#.????.?# 8,2,4,1\r\n.?#?####??? 7,2\r\n???#??#?.??? 4,3\r\n..????##????????.? 8,2,1\r\n???#?#?##?.???.? 7,2\r\n?#???#?#.?.??#.?. 6,1,1,3,1\r\n???.?#?.?? 1,1,1\r\n???????#..# 4,2,1\r\n?.?#.?????? 1,1,2\r\n.????????#???##?#? 4,1,4,4\r\n???#?#?????#?#?? 1,13\r\n#????#????.#?#???#? 2,5,8\r\n.????#.#??. 4,2\r\n??#????#??? 8,1\r\n?.##.??#??? 2,4\r\n#????#?#?#?.?????#? 1,1,1,4,1,3\r\n????#????.?????##??? 2,5,1,1,2,1\r\n..???#??..?#? 6,2\r\n?#?.?.##???????? 3,1,2,4,1\r\n.?.???##?????# 1,5,1,1\r\n?.#????.??? 2,1,1\r\n?#?#?#.???..???.??? 5,1,3,3\r\n.?.???#??#?.???#? 1,6,4\r\n?#???.?#?#.????#? 5,4,1,2\r\n.?#????????...#??? 2,2,4,4\r\n?????.???#? 1,4\r\n????#?.????.?#??.??? 5,1,2,1,3\r\n????????.? 2,2\r\n..??#???#?#.?#? 9,1\r\n????????#????#????? 5,3,1,1\r\n#?????#??????. 1,1,3,1\r\n?..#?.#???? 2,4\r\n..#?????????#?#???? 1,13\r\n?.?#.???#?? 1,2\r\n#?.#??????????#? 1,2,1,2,3\r\n.???????.?#.?? 1,3,2,1\r\n.????.?#?????##?? 3,3\r\n????###?##??.??#???? 1,8,5\r\n#?.?####????.? 2,6,1,1\r\n??.##???#?????? 1,6,2\r\n??.??#???#?#? 1,3,1,4\r\n.??.???.?#?#??? 1,2,5\r\n??.#.?#???.##??? 2,1,1,1,5\r\n???.???.??.?????#? 1,1,1,1,3,2\r\n?#?.?#?##???#???#??? 1,11,2\r\n??#????.?. 1,1\r\n.?#??##??#???.?? 10,1,2\r\n?#?#?.?#.? 1,1,2\r\n????#???????#. 3,1,1,1\r\n.??#?..??.???.??? 3,1,2,1,1\r\n.?#??.???#? 2,1,1\r\n?.?#.??##?????????? 1,1,8,1,1\r\n?.?????.??#?? 4,1,1\r\n?.??.#???? 1,4\r\n???#???..???.? 2,1\r\n.??????#?#??.?.? 2,5,1,1\r\n#??#??..?.?.???.#?? 6,1,1,3\r\n.???.?#?#??.??#???? 3,1\r\n.??#?..???? 4,2\r\n?.##???#???#??#.?? 2,8,1\r\n????#.#.???.???# 1,1,1,2,4\r\n#???????????.???#.? 6,1,3,1,1\r\n?#?????.??##??. 1,1,1,1,2\r\n?..????..?#? 1,1,1,3\r\n.??..????.?#?? 2,1,1,3\r\n????????????. 1,1,7\r\n???.?.??????#.?? 1,1,1,3,1\r\n?##...?..##??. 2,3\r\n.???##?????? 1,5,1\r\n.??#?.??????#???#?? 4,7\r\n.?#???.?.?? 4,1\r\n.???###???#??..???? 8,1\r\n???.?????#??##?.. 3,5\r\n??##??#??????? 5,2\r\n.?.???.#..? 1,1\r\n??##.??#??#???. 4,6\r\n?#????#..##?#? 1,3,4\r\n.?.?.??..? 1,1,1\r\n??????????#??#. 1,1,1,1,2\r\n??##???.???.????. 1,5,3,1,1\r\n???????.?????#?##??? 7,9\r\n##..#???.?#???#?? 2,1,1,4,2\r\n????#??#??????? 8,1,2\r\n.##?##???????.???# 7,1,2,1,1\r\n#.?..????#?#. 1,1,1,5\r\n???#??#????.??? 2,1,1,1,1\r\n#.??#.???#?##?#????? 1,1,1,3,4,2\r\n???###?#?.???.??? 6,2,1,3\r\n???#?#???????? 8,1\r\n??????.#???.?..??.? 3,1,3,1,1,1\r\n???#?##??#?.??.#.?? 1,8,2,1,1\r\n??????##???.#??#?? 8,2,3\r\n??.??#??.??.# 2,1\r\n??#.???#??????#? 3,3,4,2\r\n#?..???????#??#???? 1,5,6,1\r\n.??####??.???. 5,2\r\n.??#???????#? 1,1,4\r\n.?????.#?#???#?# 1,1,3,1,3\r\n.??#??#???..#.?.?# 1,1,4,1,1,1\r\n??.??????????.? 2,2,3,1\r\n???#.?.???##?## 4,8\r\n.?###??????#??#??? 5,7,1\r\n??.???.??#????#??? 2,2,1,1,5\r\n#???????.?#.#???### 3,1,2,1,3\r\n.????#???..?.#?? 4,1\r\n???????????.?#.?? 3,2,4,1,2\r\n.??#.#?.?.??##?.? 3,2,1,4\r\n??#??.?##???#? 2,3,2\r\n?????###?.? 2,5,1\r\n#?#.?##????#???? 1,1,3,1,5\r\n???#??#????????## 9,2\r\n?#??##??##???##??.?? 2,11,1,1\r\n???.?#.???? 1,1,1\r\n#???#????????.#? 1,4,1,2,1\r\n?#??.??##? 2,4\r\n.###??#??#??#?# 3,10\r\n#.????#?#??????#?? 1,2,4,2,2\r\n??..????.? 1,1,1\r\n#??##?..??????? 5,1,1,1\r\n##????.?.##???. 3,1,5\r\n???##.????#? 5,1,3\r\n?.????.##.? 1,2,2\r\n?#????##??????##???? 1,2,3,8,1\r\n???#?????.?..? 3,1\r\n?#?#??.#??#?.? 5,4\r\n??.?###??????? 1,4,1,1\r\n..##????#???#???? 4,6,3\r\n?????#??????.???# 7,3,1,1\r\n??#???????. 3,1,1\r\n??????##??????. 1,1,2,1,1\r\n?????.??????. 1,1,2,1\r\n?.?.??.?#?????#?##.# 1,1,1,8,2,1\r\n?.#???????#?? 2,1,3,1\r\n.#????..??#?..?# 4,1,1\r\n.??.??#??? 1,1,1\r\n##??###??.??? 8,1\r\n????#???????.????? 6,1,1\r\n#?#??#??..????? 1,2,1,1,5\r\n.?#????.?.??#? 6,1,1,2\r\n????..?##.?.?.????#? 4,3,1,1,1,3\r\n.#???????##??.???#?# 5,6,4\r\n##??????#?..#??? 2,1,5,1,1\r\n#????????#?#.#?.? 1,1,1,4,1\r\n#??#???#.?????#???? 8,1,1,5\r\n#?.?#??#?.? 1,2,2\r\n?.#?#??.?????..? 4,3\r\n?#?#???.?? 4,1,1\r\n???????#????#???.? 1,2,2,2,4,1\r\n????#??..?.??#?#?. 5,3\r\n..??#?#????????#???. 5,1,3,1,1\r\n?.#???.???. 1,2\r\n??????????.?.??? 6,1,1,1,1\r\n?#??????.? 3,2,1\r\n.?.##???## 1,7\r\n?.?????#??##??##???? 1,16\r\n??#????##?#??? 1,1,7,1\r\n.?????????? 5,1\r\n??????????.? 2,1,1,1\r\n##?.?????. 3,1\r\n?#?..?.???? 2,1,1\r\n#..???#??#???# 1,2,8\r\n??##?????#????? 3,9\r\n???#?.?##. 3,3\r\n??.??#?#??##?#.# 9,1,1\r\n#.??#?#??. 1,3\r\n.??#????????????? 3,1,2,3\r\n??#??#???.?.?? 7,1\r\n??#..##????#??#????? 2,10,2\r\n#?###????##?..??? 11,2\r\n.???#.??#.?##.?? 1,1,1,3,1\r\n?#??????#? 5,1,1\r\n?.?##??#??????? 5,4\r\n.?????.?#??.. 2,2\r\n.??.?#####?????##? 7,4\r\n??????.#?.. 1,1,2\r\n??#??????..?? 3,1,2\r\n??????????# 4,2\r\n?.?######???. 1,7,1\r\n????#?????????# 10,2\r\n.???#?#?#? 1,2,4\r\n?##????.???#?#?? 5,5\r\n.??#??.?#?#?.##? 1,4,2\r\n#.????????#????. 1,6,2,1\r\n?###????.?#?#??#??.? 6,9,1\r\n?..??..??###. 1,2,5\r\n?????#?????????.??. 1,1,3,6,2\r\n?.?#??.??? 1,1,2\r\n.??.?????????. 1,5,1,1\r\n????#??.?????## 3,6\r\n##?#??.?????. 4,1,1,2\r\n??#????#??.????#?. 8,1,2\r\n.???????#.?.?#??#??? 1,2,2,1,7\r\n?#.#???.?#?????# 1,1,1,1,5\r\n??#?##?.??# 6,3\r\n??????.##??#??###? 1,1,1,5,4\r\n???#???????##??. 2,1,1,2,1\r\n?????#..????#??##? 6,1,3,3\r\n????#??#??#??????##? 11,3\r\n.##??##?????.#?#?? 11,1,1,1\r\n?.?#?.?????.?? 3,4\r\n###?.????#?? 3,1,3\r\n????..?##?.??????#?? 3,2,9\r\n?#?.???#??#. 2,1,4\r\n??##?#?.#.???#??? 6,1,1,1,1\r\n#??????.???.#?#??. 4,2,1,1,3\r\n.?#???????.##? 7,2\r\n???#???.?.?#?#?. 4,1,5\r\n?.?????#.??#???# 6,3,1\r\n.??#??#??.?#??? 6,1,1\r\n??#????????. 5,1\r\n????????????? 1,4,1\r\n?#??#?####?.??.?#... 10,1,2\r\n#????#??????#???.?? 1,1,4\r\n?.???.???### 1,1,1,4\r\n?####??.?.??????. 7,4\r\n#???.#?#?#?#.?#?? 2,7,2\r\n???..?.??#???. 1,1,6\r\n???????.????####??.? 4,1,10,1\r\n??.?#?????????..?.# 2,11,1\r\n???.???#??.. 1,1,3\r\n?.?#?#??#????#?? 1,2,2,3\r\n???#????.?#??. 3,1,1,1\r\n.????????? 1,1,1\r\n?.?.????##?###??.?? 1,11,1\r\n?#????.#?#??? 1,1,1,2\r\n#.?.?..#?#?#????? 1,1,3,4\r\n?#?.??..?##?##????? 3,10\r\n?????????#????.#???? 1,7,1,2,1\r\n?#????????.#?# 1,4,2,3\r\n.????????#?. 6,2\r\n?.?#.??##.#??.?#?? 1,2,1,2,1,2\r\n.?????#??.?#?? 2,3,2\r\n#?.##?..#.???????? 2,2,1,5\r\n?????.?#????? 1,1,1,3\r\n???????#?##??#??? 1,10\r\n???##?..#? 1,3,2\r\n???#???.???.?? 2,1,1\r\n#?.#..?.?? 1,1,1\r\n????#???#?. 2,6\r\n##.?.????#??.?#?## 2,1,1,1,1,5\r\n??...?#??##.#???? 2,5,1\r\n??????..?#???? 3,1,1,1\r\n?#?.?##???#?.???? 1,8,1\r\n???##?#???????.#? 5,6,1\r\n?????..?#????# 1,1,2,2\r\n?###..??#? 3,4\r\n..?#??#????# 5,3\r\n???.???#????. 1,1,6\r\n??#?.??#?.???. 1,3\r\n?..????...?.????? 4,1\r\n#.??#??#?.#??#??#?# 1,6,1,7\r\n?.????..?.?? 1,3,1,2\r\n.??#???#??????#?.?# 1,1,10,1\r\n.#.?.??#?.?.#?? 1,1,2,1\r\n?.?.??.#???#? 1,1,1,3\r\n?.???.???.?? 1,3,2,2\r\n.????.??????. 1,1,1,2\r\n?.?#??????.??#? 1,5,1,1,1\r\n?????????#. 1,2,1\r\n.?.?#??##???? 1,6,1,1\r\n?#??#??.#? 1,1,1\r\n??.???????#??#.? 2,1,1,5\r\n#?.#??.?.##..##?.?. 1,3,2,3,1\r\n????????#?.##?#? 2,1,2,5\r\n?#?????.#?#.??#? 3,1,1,1,1\r\n????#?#?????#? 2,3,4\r\n?.???????#. 1,3,1\r\n???????##?#???.????. 14,3\r\n??????#?.#?#?? 6,4\r\n?##?#.??##?.# 5,4,1\r\n#??.???###?????? 3,1,3,1,1\r\n?#?#??.???#?#??? 5,2,4\r\n.???#?.#?####. 1,1,6\r\n.???.?#?#??.# 2,1,2,1\r\n#.#??#????? 1,6,1\r\n?.??.???.. 2,1\r\n?.??.#?##.?????#???. 1,4,8\r\n.#?#?#?#???..?#??# 9,4\r\n.#.?#?#??.# 1,6,1\r\n#?#.???#?????? 3,1,7\r\n??#?###??#?#??#??? 1,6,1,1,2,1\r\n??.?##???#?#?.? 1,10\r\n.#?##???#???##???..# 1,11,1,1\r\n??.#?.????#???# 1,1,7,1\r\n#????????#? 1,6,1\r\n????.#?.??#???#.?# 1,1,1,4,1,1\r\n.???#?#??.?.???# 7,4\r\n???##??????..## 8,2,2\r\n?#?#?.?.?##?## 5,5\r\n?.?..???.. 1,2\r\n.?.????..# 1,3,1\r\n#??????#??.?#?###??? 1,1,1,1,1,8\r\n.??#??.?.???? 4,1\r\n??????##?.. 2,3\r\n?#.????.#?# 1,1,3\r\n.?????..?????#. 2,1,2\r\n????#?#?##.????? 10,1\r\n?????.????#?? 3,1,1,1\r\n.??????.??.??..? 6,1\r\n?????????#??#???# 1,2,3,5\r\n#??####??..??#?.. 9,1,2\r\n?####??##?.????? 9,1\r\n?##??#??.???#. 6,4\r\n#.#?????????.#????? 1,1,1,1,1,5\r\n??#???????###??#??? 5,8\r\n#??##?????#????#? 1,7,1,1,1\r\n????????#?.????.???. 1,1,3,1,3,3\r\n??.??????? 1,2,1\r\n.?####???.???#?.? 4,1,3\r\n.???##??#?????.???? 13,1\r\n???.??#??#?????????? 1,1,3,7\r\n?????..??.?? 1,1,1,2\r\n?#???#??#??#???.??? 7,6,1\r\n???#???#?#??????. 6,1,2,1,1\r\n???????.?????? 1,3,2,1\r\n..#???#???#????#? 1,10\r\n??##??##???.???# 6,1,1\r\n#?#???###?##?.?????? 1,1,1,7,1,1\r\n??#?.?#?.???? 1,2,2\r\n.?..???#.? 1,4\r\n#??????#.?#?.##???## 3,1,2,7\r\n...#??#??#?##??.. 10,1\r\n.#??.??????????? 3,2,1,1\r\n?#??#?#?#????###??. 2,15\r\n?#????#??.?????? 2,4,6\r\n??.??.????##. 1,1,1,4\r\n.??#???.?.?????? 4,1\r\n?#??.??##??#??.? 2,8\r\n????#?#??#???##????. 1,15\r\n.???????#..?#?? 2,4,2\r\n?.?#?#?.#.?.??? 1,2,1,1,1\r\n???????#?##?#??? 1,6,2,1,1\r\n#???#####?.???#??. 10,4\r\n??????#.?????.? 2,3,4\r\n?.?#?#?????.? 4,1\r\n?.#?#?..????????#. 1,4,1,3,1\r\n.?????????#??##?? 3,1,7,1\r\n#.?.?.???##.??? 1,1,1,2,1\r\n?#.??##??.?..#? 2,3,1,2\r\n?#.?.????????#? 1,2,6\r\n???#?.??##?#???#??. 1,2,1,10\r\n???????.?#????? 6,3,2\r\n????#?.????.??.? 1,2\r\n#???.??#.??? 1,1,3,2\r\n???.??#??#????? 1,2,3,1\r\n?#?#????#?.?? 2,1,4,1\r\n.#???????#??#? 3,1,5\r\n?#.???.#.????#? 1,2,1,5\r\n.???#???##.??????.# 6,2,1,1,1,1\r\n.??????????? 1,1,4,1\r\n..??????????#?#?#?#? 6,10\r\n???.#????#.# 1,3,1,1\r\n#???????##?#..?? 1,1,5,1,1\r\n??#???#?#?.??...??# 10,1,2\r\n?#???#??..?????#???. 7,3,2\r\n???????????#??. 1,2,1,1,1\r\n#????#???##??.?.?#.? 1,11,2\r\n?????.??.???.?# 5,1,3,1\r\n?.#?#?#?#?#?#??? 1,1,1,3,5\r\n??.????.???? 2,3\r\n???????#??#? 1,3,2,1\r\n???.??#???#? 1,4,2\r\n??.??#?#.#????? 1,1,1,2,3\r\n???#????.?????.?.??? 5,1\r\n???#?.???##???####. 2,10\r\n.??#..?.???? 2,2\r\n?#.???#??##??? 1,7\r\n?????????##?? 3,1,3\r\n.?#?#?.?.#? 4,1,2\r\n.?.?#??.????#?? 1,2,1,3\r\n?#?#?????.??#?.??? 7,3,1\r\n.#???????#????.#..?? 3,4,3,1,1\r\n?.?#.????.#??#???# 1,1,1,1,6\r\n??##??#???#?#..# 4,7,1\r\n????#????. 5,2\r\n??#?#?.?.?..??? 2,1,1,1,1\r\n##????#?##??? 2,1,1,5\r\n??#..?#?##??? 2,8\r\n?.??#??????#?? 6,2\r\n??.?.???.??? 1,1,1,1\r\n?.?????#??? 1,4\r\n??#???????#??????? 1,7,1,1,1,1\r\n????..??.?????.#?? 2,1,1,1,1,3\r\n?#?#??.???????? 2,2,6,1\r\n??.??#?????##?? 2,2\r\n???.???????????.?? 1,2\r\n??##??????#?#??.# 2,1,2,3,1\r\n??????#??#? 3,1,1\r\n??.?????##????##??? 2,14\r\n?#?.?..??? 1,3\r\n?.??????#? 2,1,1\r\n??.??##.?? 2,2,1\r\n.??.??.??? 1,1\r\n.?#????#??. 2,3\r\n???????#???.#? 3,2,1\r\n??#???..?? 6,1\r\n...?#???###????? 2,4\r\n#?.?.???????? 1,1,1,2\r\n?????#????#??.?? 7,2\r\n.?????#??.???????? 4,3\r\n?###??.?.?.?##??#?? 3,1,1,7\r\n??#?#?##??...??? 9,1\r\n?????#?#?????.?##? 12,3\r\n???????????..#??. 8,3\r\n?#??#?##???#??? 7,1\r\n??????###??## 1,10\r\n?#??????#????#####.? 2,2,1,8,1\r\n.?###???..??#???.? 4,1,3\r\n?.???????? 1,6\r\n???#??#.??#?##??.? 4,2,7\r\n??.#??#??##??#?##. 2,2,11\r\n??.??#?#... 1,4\r\n.?.#?#?.?????#? 1,4,5\r\n.?????.???#?#?#??#? 4,9\r\n??.#?????#?#????? 1,12,1\r\n???#???#????.#???? 1,7,1,1,1,1\r\n??.?????##?.?..#?#.# 1,1,3,1,3,1\r\n.?#??##?????###?# 1,7,3,1\r\n#???????????#????#?? 1,2,1,1,1,7\r\n####??##???#??. 9,4\r\n???#???#?.??#? 4,3,1,2\r\n???..#???? 1,1,1\r\n?#????#?.????.??#? 3,1,1,2,1\r\n.?#????##? 4,4\r\n??.???.??? 1,2,1\r\n.??##??.????#??? 3,1,8\r\n????????#? 1,4\r\n.#????#???????.?.? 6,1,2,1\r\n??.??????##??#?#?#? 1,1,8,3\r\n??????###? 1,3\r\n???#..#??#.??.?#? 4,1,2,1,1\r\n?.##??#????..##?? 7,2\r\n#??#????#?? 5,2\r\n.#??.?#?#???? 2,3\r\n?.??#??##?????.??#? 3,2,2,3\r\n?.#???##????.? 10,1\r\n.##???.#??? 5,2\r\n??#?????.?#.???.?# 2,2,1,1,3,1\r\n?#?????.#??#???#???? 1,10\r\n?##?#..???#??#??#??? 3,1,1,6,1,1\r\n?.?????#?????????.. 2,3\r\n????#??#????#???. 1,12\r\n.#?????#????????###? 1,11,3\r\n#?#??.??###?? 3,1,3\r\n.#?????.??##???#??? 3,10\r\n.#?.??#??? 2,1,1\r\n.???##?..?. 5,1\r\n?.??#??.???? 2,1,2\r\n?.??.#?.????#?????# 1,1,2,1,9\r\n.??????#?#????.?#?. 8,1,3\r\n?##???????.#. 3,3,1\r\n#???????#.???? 9,3\r\n?#???.##??#??? 4,7\r\n????.?#??.?.#?#??? 2,4,5\r\n.?????#?#??#?????# 7,1,1,1\r\n#??..???#??#? 3,4\r\n???.??##?????##??#?# 3,7\r\n?#?#.??.?#.?#.? 1,1,1,1,1\r\n#.??????????? 1,4,3\r\n...???????##??#??#.. 1,12\r\n.???###????#??##???# 1,15,1\r\n???.?.?#?##..#? 3,5,2\r\n..??????.??#??. 2,2,4\r\n##???#?#?????? 8,3\r\n???.???#??? 1,4\r\n???.??.?#?????.#???? 2,1,3,2,1,1\r\n???#?#??#.? 1,6,1\r\n??###?????#?##.???# 10,2,1,1\r\n???##???..#??? 4,2\r\n?##??#.?#?##? 5,5\r\n??????.?#.?.?.? 1,1,2,1,1\r\n???.?#?#?.?.? 1,1,2,1\r\n???.??#?.?? 1,2,1\r\n?#????.?#.??? 5,1,1\r\n?.???.??#? 2,2\r\n??.??#??????#????##? 1,16\r\n????.????.??.?.#?#?? 1,4,1,1,1,1\r\n.??#??????? 1,3\r\n???.?????.. 1,1,3\r\n#??#?..???#?..?? 4,1,2,1\r\n??????#.????? 7,1,2\r\n?###???..?#?? 6,2\r\n?????????#??#.?? 1,1,4\r\n.????#????. 4,2\r\n.?#.?..??#.?##??# 2,1,2,2,1\r\n#?#?????#??#?.?#.#? 6,1,2,1,1\r\n????.#???#???? 2,1,2,1\r\n???#????????..#?? 8,2\r\n??##?#???.?#?..???. 6,3,2\r\n????.??#??#.?#??? 4,6,3\r\n???##??##?? 5,3\r\n???????.#..#???# 3,1,1,1,3\r\n?????????? 2,1,1\r\n#??#????#?#?????#? 11,1,3\r\n#??#??#?.???##??? 1,2,2,7\r\n#?.???#?##?##?? 2,1,9\r\n..??..??..?? 1,2\r\n.????.?#?#?.?. 4,5\r\n#???#??#???.???#??? 2,4,1,1,1,1\r\n.??#..??????#???#?. 3,1,9\r\n#???????#.????? 2,1,1,2,1\r\n??????##????#??.??. 8,1\r\n???.??#?...?#?#? 3,4\r\n?.??.#??#? 1,1,4\r\n?.??#?#??.??? 1,4,2\r\n?##??#??.????.??? 6,1,4,1\r\n??.?????#??? 1,3,1,1\r\n?.?????????#?#??? 5,8\r\n?.?????.#?##?. 1,1,1,4\r\n.?????##?#??.? 11,1\r\n.?.??#?????????# 1,1,1,5\r\n#?#????..?#??#??? 6,5,2\r\n?#??#??#?#?.???#??? 10,2,1\r\n.??????#.? 4,1,1\r\n????.?#.????? 2,1,4\r\n???????.?##? 2,4\r\n?#????#???? 4,4\r\n?.?#.???.?## 2,1,3\r\n?.????#...???..??. 4,1,1\r\n?#???#????#. 8,1\r\n?#.??????.?####?. 2,2,2,5\r\n??#?????#.?? 5,3,1\r\n?#????#??????#..?# 7,4,1,1\r\n#?????.???#?##?? 1,1,1,2,4\r\n##?#????.???. 8,1\r\n?.???????##??? 3,6\r\n???????##??#???. 1,7,1,1\r\n#?????#?.??##??????# 1,5,7,3\r\n.???????.# 2,1,1\r\n??????.?#?? 3,2,3\r\n??????#????. 7,1\r\n??#?.??.??? 3,2\r\n..??????#?#???#.? 9,1\r\n##?#??..#.? 5,1,1\r\n?#??#.????.???? 4,1,1,1,1\r\n?????#.#.?.??? 2,1,1,2\r\n???###?..??. 4,1\r\n??####?#?????#? 7,1,1\r\n??###?#???.#???????? 9,1,2,2\r\n??.??.?..####?#??? 1,6\r\n.???#?????????????# 3,2,1,1,1\r\n??#.????.????????? 2,3,5,1\r\n.?..?#?#??????#??. 1,10,1\r\n#?.???#..???. 1,4\r\n?#????????#?.. 5,5\r\n???#.#??#?##???##. 3,7,4\r\n.??###?#?.?????..?? 6,4\r\n???.???##???.??# 3,1,5,1,1\r\n..????.???? 2,1\r\n?#..?##??.#??#? 1,4,2,2\r\n????..??#?#?? 1,1,2,3\r\n#???.???????? 2,4\r\n..??????#??.???.??? 7,2,1\r\n?.#???????.. 3,2\r\n??????##????? 9,2\r\n??.#.??.?#???#?# 1,1,3,3\r\n????.#.???? 3,1,1\r\n#??.?##??#??#.?? 1,1,9,1\r\n?.????..??.???? 1,3,1,1,2\r\n??.???##??.#????? 1,5,4,1\r\n???.??.?????.?.???# 3,1,2,1,1,4\r\n?#.#???..??#??#? 2,1,1,4,2\r\n?.??.?..?????.???. 1,1,1,5,1\r\n.?#???.??.????????? 4,1,1,3,1,1\r\n???.?#.???. 2,1,3\r\n???.?#??????# 1,3,1,2\r\n????????.?????. 5,4\r\n??#.??.??? 1,1,3\r\n??#?..?#???#?.? 3,4,2\r\n????#??##???????? 7,1\r\n#??????##?.## 1,1,3,2\r\n???#.?????# 3,4,1\r\n#?#?.??????# 1,2,3,1\r\n?.??#..#..?? 2,1\r\n?????????.?????..? 7,1,1,1\r\n?????.???.??#??.??# 2,1,1,1,3,2\r\n?.?.??#?.#?# 1,1,1,3\r\n????????#.? 6,1\r\n#.????##???????? 1,5,3,1\r\n..???#.?.#?#??#??# 4,1,4,1,2\r\n.?.#?.??.??? 1,2,1,2\r\n??#??.?#???.. 2,3\r\n???#??#????#? 7,2\r\n??##?.??#? 3,4\r\n?.????#????.#?#? 1,2,3\r\n.???.???#?#????? 2,5,1\r\n.##.??.#.##? 2,1,1,2\r\n??????#??????##?.? 1,4,3,4,1\r\n???????#???.?#?# 6,4\r\n??..?????????.#??#. 1,8,1,2\r\n????????.? 1,2,1\r\n??##??##???#?.??#??? 3,6,6\r\n.??#?#???????? 3,2\r\n.??????.??##???..? 5,4\r\n????????..? 2,4,1\r\n.#?????#?#??????? 1,9,2\r\n?#####??#???.#?? 7,1,1,1\r\n#???.?#.#.?#?#?###?? 1,2,1,1,8\r\n.?#?????.??????? 6,4\r\n????.?.??##.????#?. 2,1,3,1,2\r\n???????????????#. 5,1,4\r\n.?..?.?##????? 1,1,4,2\r\n..???????? 2,2\r\n??.??#?#.? 1,5\r\n?#???.#####??? 3,5\r\n??..#?#?#???#??? 1,3,8\r\n.????????.???#? 2,1,1,1,2\r\n?????.#???????#.#. 1,2,1,2,1,1\r\n????#???#??#.?? 6,5\r\n??.?#??#??#?.??#?#?? 5,2,4\r\n???###??#?#????. 8,5\r\n.??????##.????#??.# 1,5,1,3,1,1\r\n.?????..?????? 1,1\r\n??##?.?.?? 3,1,1\r\n???#??###??????##??? 1,6,8\r\n.????#.???????.?#?#? 1,1,1,6,1,1\r\n???#..?#.?.?? 4,2,1\r\n?.?.#.?#?## 1,1,5\r\n?#???.?#?? 4,2,1\r\n?#?#?#???#?.??#.??# 5,2,1,1,1\r\n.???#?.?##?? 1,5\r\n?#???.?#.? 4,1\r\n.##??#?#...?? 7,1\r\n?##?.?.?.?#?..??. 2,3\r\n??#?#.??#?????? 4,2,2\r\n?#?###?.????.? 7,1,2\r\n#?.#?#?.?#?.#? 1,4,1,1\r\n...#?#???.???? 4,1\r\n.#?????#.?##??? 1,1,3,3,1\r\n.??#????###?????? 3,8,1\r\n?.???#??????????#??? 4,9\r\n.##?????#?? 5,1\r\n??.????#?????.?.. 1,10,1\r\n.??#?#?????..#.?.??? 2,3,1,1,1,2\r\n??????#???? 2,3,2\r\n??#??????#?????# 6,1,1,4\r\n???????.?#.??#?# 2,2,2,1,1\r\n?#.????#?? 2,6\r\n??#????????.. 5,1,2\r\n?????#????#??#?.?#?. 8,5,3\r\n??##????#?..? 5,3\r\n.?????.????#? 3,4\r\n...?.?????????#???. 1,8\r\n#?????#??.. 7,1\r\n.??#????????? 4,1,1,1\r\n?#.??????.???? 2,1,2,1\r\n#???#?#?#?????????? 9,1,1,1,1\r\n??.?.??..??#.?# 2,1,1,3,2\r\n?#?#??#???#.????.?? 10,1,2,1\r\n.???#.?????.? 3,3\r\n???#??##??.????#??#? 8,1,1,1,1\r\n????..??????#?? 1,2,2\r\n?#.?.?#..#??#?.? 2,1,1,5\r\n????###.#..? 1,4,1\r\n.????????? 1,1,1\r\n?.?...????? 1,2\r\n??#??.??##?? 3,6\r\n?.????#??#?.#?? 1,9,2\r\n?###??????#.???. 11,1,1\r\n?????#.?????? 3,1,1,1\r\n?.##..?????.?#..?? 2,1,2\r\n??#??#?????..? 4,1,1\r\n?##?#?#??.??#. 5,3,3\r\n.??.#????#???#???? 2,1,7,2\r\n?.#???????????????? 1,1,9,3\r\n.???#????##.? 1,2,2,1\r\n?#?.?.???#??#?..?.?? 1,1,6,1,2\r\n??#?????????#??? 4,1\r\n??????.??###?????.#. 3,1,1,3,4,1\r\n?????#.#.?.?#? 5,1,1\r\n????####..?#..#?# 7,2,1,1\r\n#???..??????...#?? 2,1,6,1,1\r\n?????#??.? 5,1\r\n.??#????#? 4,1\r\n???.#???.??#? 4,2\r\n.#????#??#?????? 3,3,1,2\r\n?????.??????.???? 1,1,3,1,2\r\n?#.##?#?.#####??# 1,4,8\r\n??.#????...?### 1,1,1,4\r\n#??#?#??#?.? 6,2,1\r\n????#???#?? 5,1\r\n#???#?#????##.?.? 13,1\r\n?###????#???. 4,6\r\n????????##???????. 1,4,2\r\n#?.????#.???? 1,1,2,2\r\n.????????#? 1,2,3\r\n?????##?#.??##?. 8,4\r\n?#??#?#????? 1,1,1,1\r\n????#??#?#? 1,5\r\n#??????#?#??????#??# 4,8,3,1\r\n?.?###??.????????? 3,7\r\n??#???#?????.?###?? 1,1,2,1,4,1\r\n?.??..?.??.????##.?? 2,1,1,6,1\r\n??#??????? 1,5\r\n???##??##???.#??#?# 8,1,6\r\n.?.??#?##?#?? 6,1\r\n????????##????#?# 1,1,9,1\r\n????.#?##?.?? 3,5,1\r\n??#??.????..?. 4,3,1\r\n#??#??????#??? 1,1,1,3\r\n###?#.?..#? 5,1,1\r\n?????#.??????#?#? 1,2,1,5\r\n#.???#??#. 1,3,1\r\n.??#?##????? 6,1\r\n?????#????..?? 7,1\r\n???#??#?#??#??.??? 1,2,3,2,3\r\n??????..#????#??.? 2,1,1,2,4,1\r\n?#.##?##??????.? 1,5,1,3,1\r\n??#??##????.????# 8,1,1\r\n???????#.#??#? 1,3,2,1\r\n?##?.?#???#???????? 2,2,3,2,1\r\n.#??..??.????#? 3,2,1,1\r\n???????.??????#.###. 3,3,1,5,3\r\n??#.#??#????. 2,4,3\r\n#.#??#????#??##????? 1,1,2,1,6,3\r\n##?#?.#?#.#.??? 5,1,1,1,1\r\n??????????##??#.?# 5,2,2,2,2\r\n??#.??#?????#?#?? 2,7,4\r\n???.???????.??#? 1,3,2,3\r\n?#.#??...?#.# 1,1,2,1\r\n???#?????#?#???#..## 3,9,2\r\n#.???????#. 1,7\r\n.??#????.?.????.?? 2,2,1,1,1,1\r\n?????..??. 1,1,1\r\n??#.???????#.? 2,5,1\r\n?????????? 3,1,3\r\n#.?.??##??.? 1,1,4,1\r\n??.????????#????? 1,2,3,1,3\r\n.#####????????? 6,1,2\r\n##????##?.?#.??? 9,1,2\r\n??#??????? 2,1,1\r\n????#?????????.?#. 14,1\r\n?##???##?.##??. 7,4\r\n#.?#?##??#?####???# 1,14,1\r\n.?##?.?????# 4,1,2\r\n.?#.#?.???# 1,1,2\r\n.?..???????#?.?# 1,1,6,2\r\n??##?#?????##??.???? 6,2,3,2\r\n??#??????.??#?? 7,2\r\n#.?.?..#?.??#?#?#. 1,1,1,1,5,1\r\n?.?#???????? 2,4\r\n????#??..???#?#?. 1,4,1,1,1\r\n???.?????# 2,6\r\n???#???##..?????..?? 2,3,3,1\r\n??##?##?#???###? 5,7\r\n.??#??##??#?. 2,5\r\n.#???#?#?????# 1,11\r\n?#?#?.?????.????#?? 2,1,2,1,7\r\n??#?????????# 3,1,1,1\r\n.??.????#? 2,2,1\r\n????????#????? 1,7\r\n?????.##???#?#? 1,3,3\r\n????#..??#??? 1,1,2\r\n?#?.?.#???# 2,2,1\r\n#..??.??????#. 1,2,1,4\r\n.##?.??#.?#.?? 2,3,1,1\r\n..?#???#???###.????? 12,1\r\n????.????#? 2,1\r\n???#.?.??? 1,1,1\r\n.??.????.# 1,1,1\r\n????.???.?.???##??? 3,1,6\r\n??#????.??.? 4,1\r\n#.?..###?? 1,1,5\r\n?????????..#.? 1,3,1,1\r\n???.###?#??.?. 1,6,1\r\n????????????#?##???? 3,1,9\r\n??.??.???? 1,2\r\n??#?.?????.???????? 4,5,2,4\r\n????#?#.?#####??. 5,7\r\n?.#?????#??? 1,3,1\r\n#????#??.?? 1,1,1\r\n.??????.????# 3,1,2\r\n??#?#?????#?.???#### 10,6\r\n?.?????#?..? 1,4\r\n???#??.#??#??? 2,5\r\n##?#?.#?##??##?????? 4,8,3\r\n???#???.??????## 3,1,6\r\n.???#??.??. 1,3\r\n.???#?.??.?#??? 1,2,2,1\r\n??#?.??#.?#.??##??? 3,2,1,5\r\n?###??#???###?#???.? 8,8,1\r\n###?.?.???..??.? 3,1,3,1,1\r\n?#?.?.##????#???? 1,1,4,2,1\r\n???????.?? 1,4,2\r\n.?#???###??? 1,4,1\r\n#.????.???#.# 1,1,4,1\r\n??#?#????.?#?.? 1,5,1,2,1\r\n.?#?#?#?##? 4,1,3\r\n????????????#?#????? 1,1,8,1,1\r\n#.????????? 1,2,2\r\n?##??.???? 3,1,1\r\n????..???.?.###?# 2,2,5\r\n#?#????##.#?? 5,2,2\r\n???.#????##?????..#? 1,1,6,2,1\r\n.#??.??.?? 1,1,1\r\n#????#??##??? 1,2,4\r\n?#????.??????.? 5,4\r\n??.?#???#?..?# 1,5,1\r\n?#???????????#???? 4,1,5,1\r\n???????#?.? 5,1\r\n?#??#?????.#??.#?? 5,1,1,1,3\r\n???.??????.?? 3,1,2\r\n?.???.#??? 2,3\r\n?.#.?????? 1,2,1\r\n#??#.??.#???. 1,2,3\r\n#???.#.?.?#?. 1,1,1,2\r\n?##??????.?#.?? 2,4,2,1\r\n.?#??#.?#??????? 4,4,3\r\n#????.???.??#???#.? 2,1,2,4,2,1\r\n?????.?????# 1,1,5\r\n#???#.#?.?????????? 2,2,2,9\r\n?#????????.?#.#? 7,1,1,1\r\n##?.????#?.?#??. 3,4,3\r\n???##??#????#?????? 11,5\r\n.??.??#??##.?? 1,7,1\r\n#??##???#.?.? 5,2,1,1\r\n???.??#????##??.?# 2,1,1,6,1\r\n??##?#????? 3,3\r\n#.?#??.????#??# 1,3,1,1,4\r\n..##?#??.?#? 5,2\r\n??.??#????. 1,4\r\n???#?.????? 4,2\r\n#?..????.?#??#?#?#? 1,3,9\r\n????##???#.?#?? 7,1,3\r\n?????#???????.?? 1,5\r\n??.??.????##??#???? 2,10\r\n??#?###?.?# 3,3,2\r\n???????#???.??.. 7,1\r\n??????????#.#?? 4,1,1,1,2\r\n?#?#?#??#??.??##??#. 9,5,1\r\n?.##?????.? 2,4,1\r\n#.???.???#??#?#?#??? 1,1,12\r\n?.?.?#???#?#?#.?#. 1,1,1,4,1,1\r\n???#?#???##????#??? 6,4,4\r\n?.????##..??.## 1,1,3,2,2\r\n.????#.?.??? 5,1\r\n?????..?.??#.?#? 1,2,1,2,1\r\n?.??#?????.?#? 1,5,1,2\r\n.????##?????#?? 1,4,2,3\r\n??.??.???.?#?? 1,3,3\r\n?.#????.???#??.#???? 1,1,1,6,1,1\r\n..#?????????##???## 1,4,4,3\r\n###??.##??#?????. 4,2,6\r\n?..?#????.??.?? 1,2\r\n.?#?.#????????.??? 3,1,3,1,1\r\n?#?????#?##?.###?#?? 3,7,5\r\n##??##??????#??..??? 13,1,1,1\r\n..#??.?#????#??? 1,2,6\r\n?????#?#?????##?.##? 1,7,1,3,3\r\n?##?#?#?##? 6,2\r\n.??#??..???? 4,2\r\n.#?##????.???. 1,3,1,1\r\n??##??.?#.? 4,2,1\r\n???.???#?# 3,2,1\r\n.????..?##???#??#. 2,10\r\n?##?????#??.## 5,2,2\r\n??????.??? 3,2\r\n??#???..?.??? 1,1,1,2\r\n#???????#?#?????# 1,1,11\r\n?##??????#?.??? 4,1,1,1,1\r\n?..??#???#????.?### 9,4\r\n?????????????#??.?? 1,1,1,4,2,1\r\n??#.#.??????.????? 2,1,1,1,4\r\n?.....?????? 1,1\r\n#???.??##? 3,2\r\n???.???.?#? 1,3,1\r\n??.???.??..? 1,1,2,1\r\n#??#???#?#??##??? 4,4,2,1\r\n.????????. 1,3\r\n.#?????.???#? 2,1,2\r\n?.?.???#..?. 1,2,1,1\r\n?###????#.??????? 7,1,1,1,2\r\n?##?#????###??.?. 6,3\r\n???#?.?#??. 3,1\r\n??#???#?.?.? 6,1,1\r\n?.??????????? 6,1\r\n...???##???.?. 5,2,1\r\n???.???.?.???## 1,1,1,1,3\r\n???.?##??#? 1,2,1\r\n###???.?#??#?? 6,5\r\n...?#???.??????#? 3,2\r\n??????#?????????? 8,2\r\n.?????#??#.??.#? 1,5,1,1,1\r\n###???#??#??????? 4,4,1\r\n.????###?# 1,3,1\r\n??#????#?#?.??? 1,3,1,1,2\r\n.#???#?##??#?#?# 1,12\r\n##.???#??.??..# 2,1,1,1,1\r\n???#.##???? 1,3,1\r\n???###???.?.##??.?# 1,7,1,2,1,1\r\n?.#.?#?#?..?..? 1,1,4,1\r\n???.??.?#?? 1,3\r\n??????#???#. 1,3,1,1\r\n?????#.#????#??? 5,4,1,1\r\n.?.????#???. 2,3\r\n???.??.?## 3,3\r\n?????#?.????#?#? 5,6\r\n???#?.???#?? 2,6\r\n...?????#.? 1,3\r\n#???#????#? 1,2,1\r\n??##????????###??. 6,1,4\r\n??#????#??? 1,3\r\n??#???#??????#?#? 7,7\r\n??####.?.?? 6,1,1\r\n.?.?.#?#??.?????? 4,2\r\n#???..#???.?? 4,3,1\r\n??..?#??#???##? 1,6,3\r\n??????#?#? 1,1,4\r\n?.???#?.???????? 1,3,2,1,1\r\n????????##????? 1,5,1\r\n????#?#?#???#.?.#? 11,1,1\r\n?????#??##??????# 1,3,3,3\r\n?.???.?#.????#?#??# 1,1,1,1,8\r\n.#?#??????#?????. 5,3,2\r\n.??###?????#??. 3,2,3\r\n?????#?##??#??? 1,1,1,2,4\r\n??#?.#..????#?.?#? 3,1,6,2\r\n?##??.????? 2,3\r\n?????#?###??#? 2,8\r\n.??#?#??.????.? 6,2,1\r\n????#?.?#???##??? 1,2,6,2\r\n??????..?#..? 2,1\r\n?.?????#???????? 1,4,2,1\r\n#.??????.?????#? 1,2,2,6\r\n#?.?.??#?.????? 2,1,1,2,3\r\n?.????#???#??????.#? 12,1\r\n?#????#??#.???#.##? 7,1,1,1,2\r\n?#???#????????.?? 5,2,4,1\r\n???????????# 3,1,1,3\r\n.???????.? 2,1,1\r\n?#????#???????? 2,1,3,1\r\n.##.?#??.#.?# 2,1,1,1\r\n??#???#???.????. 5,1,1,1\r\n..????..?????? 1,3\r\n#??#??#????.?.# 5,1,2,1,1\r\n??#.?#????.. 2,3,1\r\n?#.??????? 2,1,1\r\n????.?#???#?? 1,2,6\r\n????#?#?..?#? 4,1\r\n??#?#????#?#????. 8,7";
            string demo2 = ".??#.#??#. 1,2";
            string demo3 = ".??? 2";
            var temp = input.Split("\r\n");

            double sum = 0;



            foreach (var row in temp)
            {
                double rowOptions = 0;

                string trimmedRow = row.Split(' ')[0].Trim('.');
                int rowWidth = trimmedRow.Length;

                var ranges = row.Split(' ')[1].Split(',');
                //List<int> ranges = new List<int>();
                //foreach (var range in row.Split(' ')[1].Split(','))
                //{
                //    ranges.Add(Convert.ToInt32(range));
                //}
                string toMatch = "";
                int checkOff = Convert.ToInt32(trimmedRow.Replace('.', '0').Replace('?', '1').Replace('#', '1'), 2);
                int checkOn = Convert.ToInt32(trimmedRow.Replace('.', '0').Replace('?', '0').Replace('#', '1'), 2);


                toMatch += "^0*1{" + ranges[0] + "}";

                for (int i = 1; i < ranges.Length; i++)
                {
                    toMatch += "0+";
                    toMatch += "1{" + ranges[i] + "}";
                }

                toMatch += "0*$";

                // ^0*1{2}0+1{1}0*$

                for (int i = 0; i < Math.Pow(2, rowWidth); i++)
                {
                    if ((checkOff | i) == checkOff && (checkOn & i) == checkOn && Regex.Match(Convert.ToString(i, 2).PadLeft(rowWidth, '0'), toMatch).Success)
                    {
                        rowOptions++;
                    }
                }

                sum += rowOptions;

            }


            Console.WriteLine(sum);
        }
    }
}
